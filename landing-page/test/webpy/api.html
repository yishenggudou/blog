<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>web.py API</title>
    
    <link rel="stylesheet" href="_static/epub.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" /> 
  </head>
  <body role="document">

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="deploying.html" title="Deploying web.py applications"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">web.py 0.37 documentation</a> &raquo;</li> 
      </ul>
    </div>

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <div class="section" id="web-py-api">
<h1>web.py API</h1>
<div class="section" id="module-web.application">
<span id="web-application"></span><h2>web.application</h2>
<p>Web application
(from web.py)</p>
<dl class="class">
<dt id="web.application.application">
<em class="property">class </em><code class="descclassname">web.application.</code><code class="descname">application</code><span class="sig-paren">(</span><em>mapping=()</em>, <em>fvars={}</em>, <em>autoreload=None</em><span class="sig-paren">)</span></dt>
<dd><p>Application to delegate requests based on path.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">urls</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;/hello&quot;</span><span class="p">,</span> <span class="s2">&quot;hello&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span> <span class="o">=</span> <span class="n">application</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="nb">globals</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">hello</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">GET</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="s2">&quot;hello&quot;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s2">&quot;/hello&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
<span class="go">b&#39;hello&#39;</span>
</pre></div>
</div>
<dl class="method">
<dt id="web.application.application.add_processor">
<code class="descname">add_processor</code><span class="sig-paren">(</span><em>processor</em><span class="sig-paren">)</span></dt>
<dd><p>Adds a processor to the application.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">urls</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;/(.*)&quot;</span><span class="p">,</span> <span class="s2">&quot;echo&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span> <span class="o">=</span> <span class="n">application</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="nb">globals</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">echo</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">GET</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span> <span class="k">return</span> <span class="n">name</span>
<span class="gp">...</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">handler</span><span class="p">):</span> <span class="k">return</span> <span class="s2">&quot;hello, &quot;</span> <span class="o">+</span>  <span class="n">handler</span><span class="p">()</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">add_processor</span><span class="p">(</span><span class="n">hello</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s2">&quot;/web.py&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
<span class="go">b&#39;hello, web.py&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="web.application.application.cgirun">
<code class="descname">cgirun</code><span class="sig-paren">(</span><em>*middleware</em><span class="sig-paren">)</span></dt>
<dd><p>Return a CGI handler. This is mostly useful with Google App Engine.
There you can just do:</p>
<blockquote>
<div>main = app.cgirun()</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="web.application.application.gaerun">
<code class="descname">gaerun</code><span class="sig-paren">(</span><em>*middleware</em><span class="sig-paren">)</span></dt>
<dd><p>Starts the program in a way that will work with Google app engine,
no matter which version you are using (2.5 / 2.7)</p>
<p>If it is 2.5, just normally start it with app.gaerun()</p>
<p>If it is 2.7, make sure to change the app.yaml handler to point to the
global variable that contains the result of app.gaerun()</p>
<p>For example:</p>
<p>in app.yaml (where code.py is where the main code is located)</p>
<blockquote>
<div><p>handlers:
- url: /.*</p>
<blockquote>
<div>script: code.app</div></blockquote>
</div></blockquote>
<p>Make sure that the app variable is globally accessible</p>
</dd></dl>

<dl class="method">
<dt id="web.application.application.internalerror">
<code class="descname">internalerror</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Returns HTTPError with &#8216;500 internal error&#8217; message</p>
</dd></dl>

<dl class="method">
<dt id="web.application.application.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>env</em><span class="sig-paren">)</span></dt>
<dd><p>Initializes ctx using env.</p>
</dd></dl>

<dl class="method">
<dt id="web.application.application.notfound">
<code class="descname">notfound</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Returns HTTPError with &#8216;404 not found&#8217; message</p>
</dd></dl>

<dl class="method">
<dt id="web.application.application.request">
<code class="descname">request</code><span class="sig-paren">(</span><em>localpart='/'</em>, <em>method='GET'</em>, <em>data=None</em>, <em>host='0.0.0.0:8080'</em>, <em>headers=None</em>, <em>https=False</em>, <em>**kw</em><span class="sig-paren">)</span></dt>
<dd><p>Makes request to this application for the specified path and method.
Response will be a storage object with data, status and headers.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">urls</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;/hello&quot;</span><span class="p">,</span> <span class="s2">&quot;hello&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span> <span class="o">=</span> <span class="n">application</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="nb">globals</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">hello</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">GET</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
<span class="gp">... </span>        <span class="n">web</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s1">&#39;text/plain&#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="s2">&quot;hello&quot;</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s2">&quot;/hello&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span><span class="o">.</span><span class="n">data</span>
<span class="go">b&#39;hello&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span><span class="o">.</span><span class="n">status</span>
<span class="go">&#39;200 OK&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">]</span>
<span class="go">&#39;text/plain&#39;</span>
</pre></div>
</div>
<p>To use https, use https=True.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">urls</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;/redirect&quot;</span><span class="p">,</span> <span class="s2">&quot;redirect&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span> <span class="o">=</span> <span class="n">application</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="nb">globals</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">redirect</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">GET</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">raise</span> <span class="n">web</span><span class="o">.</span><span class="n">seeother</span><span class="p">(</span><span class="s2">&quot;/foo&quot;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s2">&quot;/redirect&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">]</span>
<span class="go">&#39;http://0.0.0.0:8080/foo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s2">&quot;/redirect&quot;</span><span class="p">,</span> <span class="n">https</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">]</span>
<span class="go">&#39;https://0.0.0.0:8080/foo&#39;</span>
</pre></div>
</div>
<p>The headers argument specifies HTTP headers as a mapping object
such as a dict.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">urls</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;/ua&#39;</span><span class="p">,</span> <span class="s1">&#39;uaprinter&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">uaprinter</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">GET</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="s1">&#39;your user-agent is &#39;</span> <span class="o">+</span> <span class="n">web</span><span class="o">.</span><span class="n">ctx</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="s1">&#39;HTTP_USER_AGENT&#39;</span><span class="p">]</span>
<span class="gp">... </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span> <span class="o">=</span> <span class="n">application</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="nb">globals</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s1">&#39;/ua&#39;</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>     <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;a small jumping bean/1.0 (compatible)&#39;</span>
<span class="gp">... </span><span class="p">})</span><span class="o">.</span><span class="n">data</span>
<span class="go">b&#39;your user-agent is a small jumping bean/1.0 (compatible)&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="web.application.application.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>*middleware</em><span class="sig-paren">)</span></dt>
<dd><p>Starts handling requests. If called in a CGI or FastCGI context, it will follow
that protocol. If called from the command line, it will start an HTTP
server on the port named in the first command line argument, or, if there
is no argument, on port 8080.</p>
<p><cite>middleware</cite> is a list of WSGI middleware which is applied to the resulting WSGI
function.</p>
</dd></dl>

<dl class="method">
<dt id="web.application.application.stop">
<code class="descname">stop</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Stops the http server started by run.</p>
</dd></dl>

<dl class="method">
<dt id="web.application.application.wsgifunc">
<code class="descname">wsgifunc</code><span class="sig-paren">(</span><em>*middleware</em><span class="sig-paren">)</span></dt>
<dd><p>Returns a WSGI-compatible function for this application.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="web.application.auto_application">
<em class="property">class </em><code class="descclassname">web.application.</code><code class="descname">auto_application</code></dt>
<dd><p>Application similar to <cite>application</cite> but urls are constructed 
automatically using metaclass.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">app</span> <span class="o">=</span> <span class="n">auto_application</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">hello</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">page</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">GET</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="s2">&quot;hello, world&quot;</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">foo</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">page</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/foo/.*&#39;</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">GET</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="s2">&quot;foo&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s2">&quot;/hello&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
<span class="go">b&#39;hello, world&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s1">&#39;/foo/bar&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
<span class="go">b&#39;foo&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="web.application.subdir_application">
<code class="descclassname">web.application.</code><code class="descname">subdir_application</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.application.application" title="web.application.application"><code class="xref py py-class docutils literal"><span class="pre">application</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="web.application.subdomain_application">
<em class="property">class </em><code class="descclassname">web.application.</code><code class="descname">subdomain_application</code><span class="sig-paren">(</span><em>mapping=()</em>, <em>fvars={}</em>, <em>autoreload=None</em><span class="sig-paren">)</span></dt>
<dd><p>Application to delegate requests based on the host.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">urls</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;/hello&quot;</span><span class="p">,</span> <span class="s2">&quot;hello&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span> <span class="o">=</span> <span class="n">application</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="nb">globals</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">hello</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">GET</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="s2">&quot;hello&quot;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mapping</span> <span class="o">=</span> <span class="p">(</span><span class="s2">r&quot;hello\.example\.com&quot;</span><span class="p">,</span> <span class="n">app</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app2</span> <span class="o">=</span> <span class="n">subdomain_application</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app2</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s2">&quot;/hello&quot;</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s2">&quot;hello.example.com&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
<span class="go">b&#39;hello&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span> <span class="o">=</span> <span class="n">app2</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s2">&quot;/hello&quot;</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s2">&quot;something.example.com&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span><span class="o">.</span><span class="n">status</span>
<span class="go">&#39;404 Not Found&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span><span class="o">.</span><span class="n">data</span>
<span class="go">b&#39;not found&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.application.loadhook">
<code class="descclassname">web.application.</code><code class="descname">loadhook</code><span class="sig-paren">(</span><em>h</em><span class="sig-paren">)</span></dt>
<dd><p>Converts a load hook into an application processor.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">app</span> <span class="o">=</span> <span class="n">auto_application</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">():</span> <span class="s2">&quot;something done before handling request&quot;</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">add_processor</span><span class="p">(</span><span class="n">loadhook</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.application.unloadhook">
<code class="descclassname">web.application.</code><code class="descname">unloadhook</code><span class="sig-paren">(</span><em>h</em><span class="sig-paren">)</span></dt>
<dd><p>Converts an unload hook into an application processor.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">app</span> <span class="o">=</span> <span class="n">auto_application</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">():</span> <span class="s2">&quot;something done after handling request&quot;</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">add_processor</span><span class="p">(</span><span class="n">unloadhook</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>    
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.application.autodelegate">
<code class="descclassname">web.application.</code><code class="descname">autodelegate</code><span class="sig-paren">(</span><em>prefix=''</em><span class="sig-paren">)</span></dt>
<dd><p>Returns a method that takes one argument and calls the method named prefix+arg,
calling <cite>notfound()</cite> if there isn&#8217;t one. Example:</p>
<blockquote>
<div><p>urls = (&#8216;/prefs/(.*)&#8217;, &#8216;prefs&#8217;)</p>
<dl class="docutils">
<dt>class prefs:</dt>
<dd>GET = autodelegate(&#8216;<a href="#id3"><span class="problematic" id="id4">GET_</span></a>&#8216;)
def GET_password(self): pass
def GET_privacy(self): pass</dd>
</dl>
</div></blockquote>
<p><cite>GET_password</cite> would get called for <cite>/prefs/password</cite> while <cite>GET_privacy</cite> for 
<cite>GET_privacy</cite> gets called for <cite>/prefs/privacy</cite>.</p>
<p>If a user visits <cite>/prefs/password/change</cite> then <cite>GET_password(self, &#8216;/change&#8217;)</cite>
is called.</p>
</dd></dl>

</div>
<div class="section" id="module-web.db">
<span id="web-db"></span><h2>web.db</h2>
<p>Database API
(part of web.py)</p>
<dl class="exception">
<dt id="web.db.UnknownParamstyle">
<em class="property">exception </em><code class="descclassname">web.db.</code><code class="descname">UnknownParamstyle</code></dt>
<dd><p>raised for unsupported db paramstyles</p>
<p>(currently supported: qmark, numeric, format, pyformat)</p>
</dd></dl>

<dl class="exception">
<dt id="web.db.UnknownDB">
<em class="property">exception </em><code class="descclassname">web.db.</code><code class="descname">UnknownDB</code></dt>
<dd><p>raised for unsupported dbms</p>
</dd></dl>

<dl class="function">
<dt id="web.db.sqllist">
<code class="descclassname">web.db.</code><code class="descname">sqllist</code><span class="sig-paren">(</span><em>lst</em><span class="sig-paren">)</span></dt>
<dd><p>Converts the arguments for use in something like a WHERE clause.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sqllist</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="go">&#39;a, b&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sqllist</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">&#39;a&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.db.sqlors">
<code class="descclassname">web.db.</code><code class="descname">sqlors</code><span class="sig-paren">(</span><em>left</em>, <em>lst</em><span class="sig-paren">)</span></dt>
<dd><p><cite>left is a SQL clause like `tablename.arg = ` 
and `lst</cite> is a list of values. Returns a reparam-style
pair featuring the SQL that ORs together the clause
for each item in the lst.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sqlors</span><span class="p">(</span><span class="s1">&#39;foo = &#39;</span><span class="p">,</span> <span class="p">[])</span>
<span class="go">&lt;sql: &#39;1=2&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sqlors</span><span class="p">(</span><span class="s1">&#39;foo = &#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">&lt;sql: &#39;foo = 1&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sqlors</span><span class="p">(</span><span class="s1">&#39;foo = &#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">&lt;sql: &#39;foo = 1&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sqlors</span><span class="p">(</span><span class="s1">&#39;foo = &#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">&lt;sql: &#39;(foo = 1 OR foo = 2 OR foo = 3 OR 1=2)&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.db.reparam">
<code class="descclassname">web.db.</code><code class="descname">reparam</code><span class="sig-paren">(</span><em>string_</em>, <em>dictionary</em><span class="sig-paren">)</span></dt>
<dd><p>Takes a string and a dictionary and interpolates the string
using values from the dictionary. Returns an <cite>SQLQuery</cite> for the result.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reparam</span><span class="p">(</span><span class="s2">&quot;s = $s&quot;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">&lt;sql: &quot;s = &#39;t&#39;&quot;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reparam</span><span class="p">(</span><span class="s2">&quot;s IN $s&quot;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>
<span class="go">&lt;sql: &#39;s IN (1, 2)&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.db.sqlquote">
<code class="descclassname">web.db.</code><code class="descname">sqlquote</code><span class="sig-paren">(</span><em>a</em><span class="sig-paren">)</span></dt>
<dd><p>Ensures <cite>a</cite> is quoted properly for use in a SQL query.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;WHERE x = &#39;</span> <span class="o">+</span> <span class="n">sqlquote</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; AND y = &#39;</span> <span class="o">+</span> <span class="n">sqlquote</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">&lt;sql: &quot;WHERE x = &#39;t&#39; AND y = 3&quot;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;WHERE x = &#39;</span> <span class="o">+</span> <span class="n">sqlquote</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; AND y IN &#39;</span> <span class="o">+</span> <span class="n">sqlquote</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="go">&lt;sql: &quot;WHERE x = &#39;t&#39; AND y IN (2, 3)&quot;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="web.db.SQLQuery">
<em class="property">class </em><code class="descclassname">web.db.</code><code class="descname">SQLQuery</code><span class="sig-paren">(</span><em>items=None</em><span class="sig-paren">)</span></dt>
<dd><p>You can pass this sort of thing as a clause in any db function.
Otherwise, you can pass a dictionary to the keyword argument <cite>vars</cite>
and the function will call reparam for you.</p>
<p>Internally, consists of <cite>items</cite>, which is a list of strings and
SQLParams, which get concatenated to produce the actual query.</p>
<dl class="staticmethod">
<dt id="web.db.SQLQuery.join">
<em class="property">static </em><code class="descname">join</code><span class="sig-paren">(</span><em>items</em>, <em>sep=' '</em>, <em>prefix=None</em>, <em>suffix=None</em>, <em>target=None</em><span class="sig-paren">)</span></dt>
<dd><p>Joins multiple queries.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">SQLQuery</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="s1">&#39;, &#39;</span><span class="p">)</span>
<span class="go">&lt;sql: &#39;a, b&#39;&gt;</span>
</pre></div>
</div>
<p>Optinally, prefix and suffix arguments can be provided.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">SQLQuery</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="s1">&#39;, &#39;</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
<span class="go">&lt;sql: &#39;(a, b)&#39;&gt;</span>
</pre></div>
</div>
<p>If target argument is provided, the items are appended to target instead of creating a new SQLQuery.</p>
</dd></dl>

<dl class="method">
<dt id="web.db.SQLQuery.query">
<code class="descname">query</code><span class="sig-paren">(</span><em>paramstyle=None</em><span class="sig-paren">)</span></dt>
<dd><dl class="docutils">
<dt>Returns the query part of the sql query.</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">SQLQuery</span><span class="p">([</span><span class="s2">&quot;SELECT * FROM test WHERE name=&quot;</span><span class="p">,</span> <span class="n">SQLParam</span><span class="p">(</span><span class="s1">&#39;joe&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">query</span><span class="p">()</span>
<span class="go">&#39;SELECT * FROM test WHERE name=%s&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">paramstyle</span><span class="o">=</span><span class="s1">&#39;qmark&#39;</span><span class="p">)</span>
<span class="go">&#39;SELECT * FROM test WHERE name=?&#39;</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="web.db.SQLQuery.values">
<code class="descname">values</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><dl class="docutils">
<dt>Returns the values of the parameters used in the sql query.</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">SQLQuery</span><span class="p">([</span><span class="s2">&quot;SELECT * FROM test WHERE name=&quot;</span><span class="p">,</span> <span class="n">SQLParam</span><span class="p">(</span><span class="s1">&#39;joe&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[&#39;joe&#39;]</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="web.db.SQLParam">
<em class="property">class </em><code class="descclassname">web.db.</code><code class="descname">SQLParam</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span></dt>
<dd><p>Parameter in SQLQuery.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">SQLQuery</span><span class="p">([</span><span class="s2">&quot;SELECT * FROM test WHERE name=&quot;</span><span class="p">,</span> <span class="n">SQLParam</span><span class="p">(</span><span class="s2">&quot;joe&quot;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span>
<span class="go">&lt;sql: &quot;SELECT * FROM test WHERE name=&#39;joe&#39;&quot;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">query</span><span class="p">()</span>
<span class="go">&#39;SELECT * FROM test WHERE name=%s&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[&#39;joe&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="web.db.sqlparam">
<code class="descclassname">web.db.</code><code class="descname">sqlparam</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.db.SQLParam" title="web.db.SQLParam"><code class="xref py py-class docutils literal"><span class="pre">SQLParam</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="web.db.SQLLiteral">
<em class="property">class </em><code class="descclassname">web.db.</code><code class="descname">SQLLiteral</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span></dt>
<dd><p>Protects a string from <cite>sqlquote</cite>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sqlquote</span><span class="p">(</span><span class="s1">&#39;NOW()&#39;</span><span class="p">)</span>
<span class="go">&lt;sql: &quot;&#39;NOW()&#39;&quot;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sqlquote</span><span class="p">(</span><span class="n">SQLLiteral</span><span class="p">(</span><span class="s1">&#39;NOW()&#39;</span><span class="p">))</span>
<span class="go">&lt;sql: &#39;NOW()&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="web.db.sqlliteral">
<code class="descclassname">web.db.</code><code class="descname">sqlliteral</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.db.SQLLiteral" title="web.db.SQLLiteral"><code class="xref py py-class docutils literal"><span class="pre">SQLLiteral</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="web.db.database">
<code class="descclassname">web.db.</code><code class="descname">database</code><span class="sig-paren">(</span><em>dburl=None</em>, <em>**params</em><span class="sig-paren">)</span></dt>
<dd><p>Creates appropriate database using params.</p>
<p>Pooling will be enabled if DBUtils module is available. 
Pooling can be disabled by passing pooling=False in params.</p>
</dd></dl>

<dl class="class">
<dt id="web.db.DB">
<em class="property">class </em><code class="descclassname">web.db.</code><code class="descname">DB</code><span class="sig-paren">(</span><em>db_module</em>, <em>keywords</em><span class="sig-paren">)</span></dt>
<dd><p>Database</p>
<dl class="method">
<dt id="web.db.DB.delete">
<code class="descname">delete</code><span class="sig-paren">(</span><em>table</em>, <em>where</em>, <em>using=None</em>, <em>vars=None</em>, <em>_test=False</em><span class="sig-paren">)</span></dt>
<dd><p>Deletes from <cite>table</cite> with clauses <cite>where</cite> and <cite>using</cite>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span> <span class="o">=</span> <span class="n">DB</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="p">{})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Joe&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="s1">&#39;name = $name&#39;</span><span class="p">,</span> <span class="nb">vars</span><span class="o">=</span><span class="nb">locals</span><span class="p">(),</span> <span class="n">_test</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">&lt;sql: &quot;DELETE FROM foo WHERE name = &#39;Joe&#39;&quot;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="web.db.DB.insert">
<code class="descname">insert</code><span class="sig-paren">(</span><em>tablename</em>, <em>seqname=None</em>, <em>_test=False</em>, <em>**values</em><span class="sig-paren">)</span></dt>
<dd><p>Inserts <cite>values</cite> into <cite>tablename</cite>. Returns current sequence ID.
Set <cite>seqname</cite> to the ID if it&#8217;s not the default, or to <cite>False</cite>
if there isn&#8217;t one.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span> <span class="o">=</span> <span class="n">DB</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="p">{})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;bob&#39;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">created</span><span class="o">=</span><span class="n">SQLLiteral</span><span class="p">(</span><span class="s1">&#39;NOW()&#39;</span><span class="p">),</span> <span class="n">_test</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span>
<span class="go">&lt;sql: &quot;INSERT INTO foo (age, created, name) VALUES (2, NOW(), &#39;bob&#39;)&quot;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">query</span><span class="p">()</span>
<span class="go">&#39;INSERT INTO foo (age, created, name) VALUES (%s, NOW(), %s)&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[2, &#39;bob&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="web.db.DB.multiple_insert">
<code class="descname">multiple_insert</code><span class="sig-paren">(</span><em>tablename</em>, <em>values</em>, <em>seqname=None</em>, <em>_test=False</em><span class="sig-paren">)</span></dt>
<dd><p>Inserts multiple rows into <cite>tablename</cite>. The <cite>values</cite> must be a list of dictioanries, 
one for each row to be inserted, each with the same set of keys.
Returns the list of ids of the inserted rows.        
Set <cite>seqname</cite> to the ID if it&#8217;s not the default, or to <cite>False</cite>
if there isn&#8217;t one.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span> <span class="o">=</span> <span class="n">DB</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="p">{})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">supports_multiple_insert</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">values</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;foo@example.com&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;bar@example.com&quot;</span><span class="p">}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">multiple_insert</span><span class="p">(</span><span class="s1">&#39;person&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span> <span class="n">_test</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">&lt;sql: &quot;INSERT INTO person (email, name) VALUES (&#39;foo@example.com&#39;, &#39;foo&#39;), (&#39;bar@example.com&#39;, &#39;bar&#39;)&quot;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="web.db.DB.query">
<code class="descname">query</code><span class="sig-paren">(</span><em>sql_query</em>, <em>vars=None</em>, <em>processed=False</em>, <em>_test=False</em><span class="sig-paren">)</span></dt>
<dd><p>Execute SQL query <cite>sql_query</cite> using dictionary <cite>vars</cite> to interpolate it.
If <cite>processed=True</cite>, <cite>vars</cite> is a <cite>reparam</cite>-style list to use 
instead of interpolating.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span> <span class="o">=</span> <span class="n">DB</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="p">{})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM foo&quot;</span><span class="p">,</span> <span class="n">_test</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">&lt;sql: &#39;SELECT * FROM foo&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM foo WHERE x = $x&quot;</span><span class="p">,</span> <span class="nb">vars</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;f&#39;</span><span class="p">),</span> <span class="n">_test</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">&lt;sql: &quot;SELECT * FROM foo WHERE x = &#39;f&#39;&quot;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM foo WHERE x = &quot;</span> <span class="o">+</span> <span class="n">sqlquote</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">),</span> <span class="n">_test</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">&lt;sql: &quot;SELECT * FROM foo WHERE x = &#39;f&#39;&quot;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="web.db.DB.select">
<code class="descname">select</code><span class="sig-paren">(</span><em>tables</em>, <em>vars=None</em>, <em>what='*'</em>, <em>where=None</em>, <em>order=None</em>, <em>group=None</em>, <em>limit=None</em>, <em>offset=None</em>, <em>_test=False</em><span class="sig-paren">)</span></dt>
<dd><p>Selects <cite>what</cite> from <cite>tables</cite> with clauses <cite>where</cite>, <cite>order</cite>, 
<cite>group</cite>, <cite>limit</cite>, and <cite>offset</cite>. Uses vars to interpolate. 
Otherwise, each clause can be a SQLQuery.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span> <span class="o">=</span> <span class="n">DB</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="p">{})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">_test</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">&lt;sql: &#39;SELECT * FROM foo&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">],</span> <span class="n">where</span><span class="o">=</span><span class="s2">&quot;foo.bar_id = bar.id&quot;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">_test</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">&lt;sql: &#39;SELECT * FROM foo, bar WHERE foo.bar_id = bar.id LIMIT 5&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span> <span class="n">_test</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">&lt;sql: &#39;SELECT * FROM foo WHERE id = 5&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="web.db.DB.transaction">
<code class="descname">transaction</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Start a transaction.</p>
</dd></dl>

<dl class="method">
<dt id="web.db.DB.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>tables</em>, <em>where</em>, <em>vars=None</em>, <em>_test=False</em>, <em>**values</em><span class="sig-paren">)</span></dt>
<dd><p>Update <cite>tables</cite> with clause <cite>where</cite> (interpolated using <cite>vars</cite>)
and setting <cite>values</cite>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span> <span class="o">=</span> <span class="n">DB</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="p">{})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Joseph&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="s1">&#39;name = $name&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;bob&#39;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">created</span><span class="o">=</span><span class="n">SQLLiteral</span><span class="p">(</span><span class="s1">&#39;NOW()&#39;</span><span class="p">),</span> <span class="nb">vars</span><span class="o">=</span><span class="nb">locals</span><span class="p">(),</span> <span class="n">_test</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span>
<span class="go">&lt;sql: &quot;UPDATE foo SET age = 2, created = NOW(), name = &#39;bob&#39; WHERE name = &#39;Joseph&#39;&quot;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">query</span><span class="p">()</span>
<span class="go">&#39;UPDATE foo SET age = %s, created = NOW(), name = %s WHERE name = %s&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[2, &#39;bob&#39;, &#39;Joseph&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="web.db.DB.where">
<code class="descname">where</code><span class="sig-paren">(</span><em>table</em>, <em>what='*'</em>, <em>order=None</em>, <em>group=None</em>, <em>limit=None</em>, <em>offset=None</em>, <em>_test=False</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Selects from <cite>table</cite> where keys are equal to values in <cite>kwargs</cite>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span> <span class="o">=</span> <span class="n">DB</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="p">{})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">bar_id</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">_test</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">&lt;sql: &#39;SELECT * FROM foo WHERE bar_id = 3&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">crust</span><span class="o">=</span><span class="s1">&#39;dewey&#39;</span><span class="p">,</span> <span class="n">_test</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">&lt;sql: &quot;SELECT * FROM foo WHERE crust = &#39;dewey&#39; AND source = 2&quot;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">_test</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">&lt;sql: &#39;SELECT * FROM foo&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-web.net">
<span id="web-net"></span><h2>web.net</h2>
<p>Network Utilities
(from web.py)</p>
<dl class="function">
<dt id="web.net.validipaddr">
<code class="descclassname">web.net.</code><code class="descname">validipaddr</code><span class="sig-paren">(</span><em>address</em><span class="sig-paren">)</span></dt>
<dd><p>Returns True if <cite>address</cite> is a valid IPv4 address.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">validipaddr</span><span class="p">(</span><span class="s1">&#39;192.168.1.1&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">validipaddr</span><span class="p">(</span><span class="s1">&#39;192.168.1.800&#39;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">validipaddr</span><span class="p">(</span><span class="s1">&#39;192.168.1&#39;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.net.validip6addr">
<code class="descclassname">web.net.</code><code class="descname">validip6addr</code><span class="sig-paren">(</span><em>address</em><span class="sig-paren">)</span></dt>
<dd><p>Returns True if <cite>address</cite> is a valid IPv6 address.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">validip6addr</span><span class="p">(</span><span class="s1">&#39;::&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">validip6addr</span><span class="p">(</span><span class="s1">&#39;aaaa:bbbb:cccc:dddd::1&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">validip6addr</span><span class="p">(</span><span class="s1">&#39;1:2:3:4:5:6:7:8:9:10&#39;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">validip6addr</span><span class="p">(</span><span class="s1">&#39;12:10&#39;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.net.validipport">
<code class="descclassname">web.net.</code><code class="descname">validipport</code><span class="sig-paren">(</span><em>port</em><span class="sig-paren">)</span></dt>
<dd><p>Returns True if <cite>port</cite> is a valid IPv4 port.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">validipport</span><span class="p">(</span><span class="s1">&#39;9000&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">validipport</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">validipport</span><span class="p">(</span><span class="s1">&#39;1000000&#39;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.net.validip">
<code class="descclassname">web.net.</code><code class="descname">validip</code><span class="sig-paren">(</span><em>ip</em>, <em>defaultaddr='0.0.0.0'</em>, <em>defaultport=8080</em><span class="sig-paren">)</span></dt>
<dd><p>Returns <cite>(ip_address, port)</cite> from string <cite>ip_addr_port</cite>
&gt;&gt;&gt; validip(&#8216;1.2.3.4&#8217;)
(&#8216;1.2.3.4&#8217;, 8080)
&gt;&gt;&gt; validip(&#8216;80&#8217;)
(&#8216;0.0.0.0&#8217;, 80)
&gt;&gt;&gt; validip(&#8216;192.168.0.1:85&#8217;)
(&#8216;192.168.0.1&#8217;, 85)
&gt;&gt;&gt; validip(&#8216;::&#8217;)
(&#8216;::&#8217;, 8080)
&gt;&gt;&gt; validip(&#8216;[::]:88&#8217;)
(&#8216;::&#8217;, 88)
&gt;&gt;&gt; validip(&#8216;[::1]:80&#8217;)
(&#8216;::1&#8217;, 80)</p>
</dd></dl>

<dl class="function">
<dt id="web.net.validaddr">
<code class="descclassname">web.net.</code><code class="descname">validaddr</code><span class="sig-paren">(</span><em>string_</em><span class="sig-paren">)</span></dt>
<dd><p>Returns either (ip_address, port) or &#8220;/path/to/socket&#8221; from <a href="#id5"><span class="problematic" id="id6">string_</span></a></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">validaddr</span><span class="p">(</span><span class="s1">&#39;/path/to/socket&#39;</span><span class="p">)</span>
<span class="go">&#39;/path/to/socket&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">validaddr</span><span class="p">(</span><span class="s1">&#39;8000&#39;</span><span class="p">)</span>
<span class="go">(&#39;0.0.0.0&#39;, 8000)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">validaddr</span><span class="p">(</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">)</span>
<span class="go">(&#39;127.0.0.1&#39;, 8080)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">validaddr</span><span class="p">(</span><span class="s1">&#39;127.0.0.1:8000&#39;</span><span class="p">)</span>
<span class="go">(&#39;127.0.0.1&#39;, 8000)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">validip</span><span class="p">(</span><span class="s1">&#39;[::1]:80&#39;</span><span class="p">)</span>
<span class="go">(&#39;::1&#39;, 80)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">validaddr</span><span class="p">(</span><span class="s1">&#39;fff&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">ValueError</span>: <span class="n">fff is not a valid IP address/port</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.net.urlquote">
<code class="descclassname">web.net.</code><code class="descname">urlquote</code><span class="sig-paren">(</span><em>val</em><span class="sig-paren">)</span></dt>
<dd><p>Quotes a string for use in a URL.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">urlquote</span><span class="p">(</span><span class="s1">&#39;://?f=1&amp;j=1&#39;</span><span class="p">)</span>
<span class="go">&#39;%3A//%3Ff%3D1%26j%3D1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">urlquote</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
<span class="go">&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">urlquote</span><span class="p">(</span><span class="s1">u&#39;</span><span class="se">\u203d</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="go">&#39;%E2%80%BD&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.net.httpdate">
<code class="descclassname">web.net.</code><code class="descname">httpdate</code><span class="sig-paren">(</span><em>date_obj</em><span class="sig-paren">)</span></dt>
<dd><p>Formats a datetime object for use in HTTP headers.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">httpdate</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1970</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">&#39;Thu, 01 Jan 1970 01:01:01 GMT&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.net.parsehttpdate">
<code class="descclassname">web.net.</code><code class="descname">parsehttpdate</code><span class="sig-paren">(</span><em>string_</em><span class="sig-paren">)</span></dt>
<dd><p>Parses an HTTP date into a datetime object.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parsehttpdate</span><span class="p">(</span><span class="s1">&#39;Thu, 01 Jan 1970 01:01:01 GMT&#39;</span><span class="p">)</span>
<span class="go">datetime.datetime(1970, 1, 1, 1, 1, 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.net.htmlquote">
<code class="descclassname">web.net.</code><code class="descname">htmlquote</code><span class="sig-paren">(</span><em>text</em><span class="sig-paren">)</span></dt>
<dd><p>Encodes <cite>text</cite> for raw use in HTML.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">htmlquote</span><span class="p">(</span><span class="s2">u&quot;&lt;&#39;&amp;</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="p">)</span>
<span class="go">u&#39;&amp;lt;&amp;#39;&amp;amp;&amp;quot;&amp;gt;&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.net.htmlunquote">
<code class="descclassname">web.net.</code><code class="descname">htmlunquote</code><span class="sig-paren">(</span><em>text</em><span class="sig-paren">)</span></dt>
<dd><p>Decodes <cite>text</cite> that&#8217;s HTML quoted.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">htmlunquote</span><span class="p">(</span><span class="s1">u&#39;&amp;lt;&amp;#39;&amp;amp;&amp;quot;&amp;gt;&#39;</span><span class="p">)</span>
<span class="go">u&#39;&lt;\&#39;&amp;&quot;&gt;&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.net.websafe">
<code class="descclassname">web.net.</code><code class="descname">websafe</code><span class="sig-paren">(</span><em>val</em><span class="sig-paren">)</span></dt>
<dd><p>Converts <cite>val</cite> so that it is safe for use in Unicode HTML.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">websafe</span><span class="p">(</span><span class="s2">&quot;&lt;&#39;&amp;</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="p">)</span>
<span class="go">u&#39;&amp;lt;&amp;#39;&amp;amp;&amp;quot;&amp;gt;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">websafe</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
<span class="go">u&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">websafe</span><span class="p">(</span><span class="s1">u&#39;</span><span class="se">\u203d</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">u&#39;</span><span class="se">\u203d</span><span class="s1">&#39;</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-web.form">
<span id="web-form"></span><h2>web.form</h2>
<p>HTML forms
(part of web.py)</p>
<dl class="class">
<dt id="web.form.AttributeList">
<em class="property">class </em><code class="descclassname">web.form.</code><code class="descname">AttributeList</code></dt>
<dd><p>List of atributes of input.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">AttributeList</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">&lt;attrs: &#39;name=&quot;x&quot; type=&quot;text&quot; value=&quot;20&quot;&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="web.form.Button">
<em class="property">class </em><code class="descclassname">web.form.</code><code class="descname">Button</code><span class="sig-paren">(</span><em>name</em>, <em>*validators</em>, <em>**attrs</em><span class="sig-paren">)</span></dt>
<dd><p>HTML Button.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Button</span><span class="p">(</span><span class="s2">&quot;save&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
<span class="go">u&#39;&lt;button id=&quot;save&quot; name=&quot;save&quot;&gt;save&lt;/button&gt;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Button</span><span class="p">(</span><span class="s2">&quot;action&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;save&quot;</span><span class="p">,</span> <span class="n">html</span><span class="o">=</span><span class="s2">&quot;&lt;b&gt;Save Changes&lt;/b&gt;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
<span class="go">u&#39;&lt;button id=&quot;action&quot; name=&quot;action&quot; value=&quot;save&quot;&gt;&lt;b&gt;Save Changes&lt;/b&gt;&lt;/button&gt;&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="web.form.Checkbox">
<em class="property">class </em><code class="descclassname">web.form.</code><code class="descname">Checkbox</code><span class="sig-paren">(</span><em>name</em>, <em>*validators</em>, <em>**attrs</em><span class="sig-paren">)</span></dt>
<dd><p>Checkbox input.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Checkbox</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">checked</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
<span class="go">u&#39;&lt;input checked=&quot;checked&quot; id=&quot;foo_bar&quot; name=&quot;foo&quot; type=&quot;checkbox&quot; value=&quot;bar&quot;/&gt;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Checkbox</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
<span class="go">u&#39;&lt;input id=&quot;foo_bar&quot; name=&quot;foo&quot; type=&quot;checkbox&quot; value=&quot;bar&quot;/&gt;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Checkbox</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
<span class="go">u&#39;&lt;input checked=&quot;checked&quot; id=&quot;foo_bar&quot; name=&quot;foo&quot; type=&quot;checkbox&quot; value=&quot;bar&quot;/&gt;&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="web.form.Dropdown">
<em class="property">class </em><code class="descclassname">web.form.</code><code class="descname">Dropdown</code><span class="sig-paren">(</span><em>name</em>, <em>args</em>, <em>*validators</em>, <em>**attrs</em><span class="sig-paren">)</span></dt>
<dd><p>Dropdown/select input.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Dropdown</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
<span class="go">u&#39;&lt;select id=&quot;foo&quot; name=&quot;foo&quot;&gt;\n  &lt;option value=&quot;a&quot;&gt;a&lt;/option&gt;\n  &lt;option selected=&quot;selected&quot; value=&quot;b&quot;&gt;b&lt;/option&gt;\n  &lt;option value=&quot;c&quot;&gt;c&lt;/option&gt;\n&lt;/select&gt;\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Dropdown</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;aa&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;bb&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;cc&#39;</span><span class="p">)],</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
<span class="go">u&#39;&lt;select id=&quot;foo&quot; name=&quot;foo&quot;&gt;\n  &lt;option value=&quot;a&quot;&gt;aa&lt;/option&gt;\n  &lt;option selected=&quot;selected&quot; value=&quot;b&quot;&gt;bb&lt;/option&gt;\n  &lt;option value=&quot;c&quot;&gt;cc&lt;/option&gt;\n&lt;/select&gt;\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="web.form.File">
<em class="property">class </em><code class="descclassname">web.form.</code><code class="descname">File</code><span class="sig-paren">(</span><em>name</em>, <em>*validators</em>, <em>**attrs</em><span class="sig-paren">)</span></dt>
<dd><p>File input.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">File</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;f&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
<span class="go">u&#39;&lt;input id=&quot;f&quot; name=&quot;f&quot; type=&quot;file&quot;/&gt;&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="web.form.Form">
<em class="property">class </em><code class="descclassname">web.form.</code><code class="descname">Form</code><span class="sig-paren">(</span><em>*inputs</em>, <em>**kw</em><span class="sig-paren">)</span></dt>
<dd><p>HTML form.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Form</span><span class="p">(</span><span class="n">Textbox</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
<span class="go">u&#39;&lt;table&gt;\n    &lt;tr&gt;&lt;th&gt;&lt;label for=&quot;x&quot;&gt;x&lt;/label&gt;&lt;/th&gt;&lt;td&gt;&lt;input id=&quot;x&quot; name=&quot;x&quot; type=&quot;text&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;\n&lt;/table&gt;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;42&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
<span class="go">u&#39;&lt;table&gt;\n    &lt;tr&gt;&lt;th&gt;&lt;label for=&quot;x&quot;&gt;x&lt;/label&gt;&lt;/th&gt;&lt;td&gt;&lt;input id=&quot;x&quot; name=&quot;x&quot; type=&quot;text&quot; value=&quot;42&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;\n&lt;/table&gt;&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="web.form.GroupedDropdown">
<em class="property">class </em><code class="descclassname">web.form.</code><code class="descname">GroupedDropdown</code><span class="sig-paren">(</span><em>name</em>, <em>args</em>, <em>*validators</em>, <em>**attrs</em><span class="sig-paren">)</span></dt>
<dd><p>Grouped Dropdown/select input.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">GroupedDropdown</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;car_type&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">((</span><span class="s1">&#39;Swedish Cars&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;Volvo&#39;</span><span class="p">,</span> <span class="s1">&#39;Saab&#39;</span><span class="p">)),</span> <span class="p">(</span><span class="s1">&#39;German Cars&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;Mercedes&#39;</span><span class="p">,</span> <span class="s1">&#39;Audi&#39;</span><span class="p">))),</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;Audi&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
<span class="go">u&#39;&lt;select id=&quot;car_type&quot; name=&quot;car_type&quot;&gt;\n  &lt;optgroup label=&quot;Swedish Cars&quot;&gt;\n    &lt;option value=&quot;Volvo&quot;&gt;Volvo&lt;/option&gt;\n    &lt;option value=&quot;Saab&quot;&gt;Saab&lt;/option&gt;\n  &lt;/optgroup&gt;\n  &lt;optgroup label=&quot;German Cars&quot;&gt;\n    &lt;option value=&quot;Mercedes&quot;&gt;Mercedes&lt;/option&gt;\n    &lt;option selected=&quot;selected&quot; value=&quot;Audi&quot;&gt;Audi&lt;/option&gt;\n  &lt;/optgroup&gt;\n&lt;/select&gt;\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GroupedDropdown</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;car_type&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">((</span><span class="s1">&#39;Swedish Cars&#39;</span><span class="p">,</span> <span class="p">((</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="s1">&#39;Volvo&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;Saab&#39;</span><span class="p">))),</span> <span class="p">(</span><span class="s1">&#39;German Cars&#39;</span><span class="p">,</span> <span class="p">((</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;Mercedes&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;Audi&#39;</span><span class="p">)))),</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
<span class="go">u&#39;&lt;select id=&quot;car_type&quot; name=&quot;car_type&quot;&gt;\n  &lt;optgroup label=&quot;Swedish Cars&quot;&gt;\n    &lt;option value=&quot;v&quot;&gt;Volvo&lt;/option&gt;\n    &lt;option value=&quot;s&quot;&gt;Saab&lt;/option&gt;\n  &lt;/optgroup&gt;\n  &lt;optgroup label=&quot;German Cars&quot;&gt;\n    &lt;option value=&quot;m&quot;&gt;Mercedes&lt;/option&gt;\n    &lt;option selected=&quot;selected&quot; value=&quot;a&quot;&gt;Audi&lt;/option&gt;\n  &lt;/optgroup&gt;\n&lt;/select&gt;\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="web.form.Hidden">
<em class="property">class </em><code class="descclassname">web.form.</code><code class="descname">Hidden</code><span class="sig-paren">(</span><em>name</em>, <em>*validators</em>, <em>**attrs</em><span class="sig-paren">)</span></dt>
<dd><p>Hidden Input.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Hidden</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
<span class="go">u&#39;&lt;input id=&quot;foo&quot; name=&quot;foo&quot; type=&quot;hidden&quot; value=&quot;bar&quot;/&gt;&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="web.form.Password">
<em class="property">class </em><code class="descclassname">web.form.</code><code class="descname">Password</code><span class="sig-paren">(</span><em>name</em>, <em>*validators</em>, <em>**attrs</em><span class="sig-paren">)</span></dt>
<dd><p>Password input.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Password</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;secret&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
<span class="go">u&#39;&lt;input id=&quot;password&quot; name=&quot;password&quot; type=&quot;password&quot; value=&quot;secret&quot;/&gt;&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="web.form.Textarea">
<em class="property">class </em><code class="descclassname">web.form.</code><code class="descname">Textarea</code><span class="sig-paren">(</span><em>name</em>, <em>*validators</em>, <em>**attrs</em><span class="sig-paren">)</span></dt>
<dd><p>Textarea input.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Textarea</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
<span class="go">u&#39;&lt;textarea id=&quot;foo&quot; name=&quot;foo&quot;&gt;bar&lt;/textarea&gt;&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="web.form.Textbox">
<em class="property">class </em><code class="descclassname">web.form.</code><code class="descname">Textbox</code><span class="sig-paren">(</span><em>name</em>, <em>*validators</em>, <em>**attrs</em><span class="sig-paren">)</span></dt>
<dd><p>Textbox input.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Textbox</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
<span class="go">u&#39;&lt;input id=&quot;foo&quot; name=&quot;foo&quot; type=&quot;text&quot; value=&quot;bar&quot;/&gt;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Textbox</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
<span class="go">u&#39;&lt;input id=&quot;foo&quot; name=&quot;foo&quot; type=&quot;text&quot; value=&quot;0&quot;/&gt;&#39;</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-web.http">
<span id="web-http"></span><h2>web.http</h2>
<p>HTTP Utilities
(from web.py)</p>
<dl class="function">
<dt id="web.http.expires">
<code class="descclassname">web.http.</code><code class="descname">expires</code><span class="sig-paren">(</span><em>delta</em><span class="sig-paren">)</span></dt>
<dd><p>Outputs an <cite>Expires</cite> header for <cite>delta</cite> from now. 
<cite>delta</cite> is a <cite>timedelta</cite> object or a number of seconds.</p>
</dd></dl>

<dl class="function">
<dt id="web.http.lastmodified">
<code class="descclassname">web.http.</code><code class="descname">lastmodified</code><span class="sig-paren">(</span><em>date_obj</em><span class="sig-paren">)</span></dt>
<dd><p>Outputs a <cite>Last-Modified</cite> header for <cite>datetime</cite>.</p>
</dd></dl>

<dl class="function">
<dt id="web.http.prefixurl">
<code class="descclassname">web.http.</code><code class="descname">prefixurl</code><span class="sig-paren">(</span><em>base=''</em><span class="sig-paren">)</span></dt>
<dd><p>Sorry, this function is really difficult to explain.
Maybe some other time.</p>
</dd></dl>

<dl class="function">
<dt id="web.http.modified">
<code class="descclassname">web.http.</code><code class="descname">modified</code><span class="sig-paren">(</span><em>date=None</em>, <em>etag=None</em><span class="sig-paren">)</span></dt>
<dd><p>Checks to see if the page has been modified since the version in the
requester&#8217;s cache.</p>
<p>When you publish pages, you can include <cite>Last-Modified</cite> and <cite>ETag</cite>
with the date the page was last modified and an opaque token for
the particular version, respectively. When readers reload the page, 
the browser sends along the modification date and etag value for
the version it has in its cache. If the page hasn&#8217;t changed, 
the server can just return <cite>304 Not Modified</cite> and not have to 
send the whole page again.</p>
<p>This function takes the last-modified date <cite>date</cite> and the ETag <cite>etag</cite>
and checks the headers to see if they match. If they do, it returns 
<cite>True</cite>, or otherwise it raises NotModified error. It also sets 
<cite>Last-Modified</cite> and <cite>ETag</cite> output headers.</p>
</dd></dl>

<dl class="function">
<dt id="web.http.changequery">
<code class="descclassname">web.http.</code><code class="descname">changequery</code><span class="sig-paren">(</span><em>query=None</em>, <em>**kw</em><span class="sig-paren">)</span></dt>
<dd><p>Imagine you&#8217;re at <cite>/foo?a=1&amp;b=2</cite>. Then <cite>changequery(a=3)</cite> will return
<cite>/foo?a=3&amp;b=2</cite> &#8211; the same URL but with the arguments you requested
changed.</p>
</dd></dl>

<dl class="function">
<dt id="web.http.url">
<code class="descclassname">web.http.</code><code class="descname">url</code><span class="sig-paren">(</span><em>path=None</em>, <em>doseq=False</em>, <em>**kw</em><span class="sig-paren">)</span></dt>
<dd><p>Makes url by concatenating web.ctx.homepath and path and the 
query string created using the arguments.</p>
</dd></dl>

<dl class="function">
<dt id="web.http.profiler">
<code class="descclassname">web.http.</code><code class="descname">profiler</code><span class="sig-paren">(</span><em>app</em><span class="sig-paren">)</span></dt>
<dd><p>Outputs basic profiling information at the bottom of each response.</p>
</dd></dl>

</div>
<div class="section" id="module-web.session">
<span id="web-session"></span><h2>web.session</h2>
<p>Session Management
(from web.py)</p>
<dl class="class">
<dt id="web.session.Session">
<em class="property">class </em><code class="descclassname">web.session.</code><code class="descname">Session</code><span class="sig-paren">(</span><em>app</em>, <em>store</em>, <em>initializer=None</em><span class="sig-paren">)</span></dt>
<dd><p>Session management for web.py</p>
<dl class="method">
<dt id="web.session.Session.expired">
<code class="descname">expired</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Called when an expired session is atime</p>
</dd></dl>

<dl class="method">
<dt id="web.session.Session.kill">
<code class="descname">kill</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Kill the session, make it no longer available</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="web.session.Store">
<em class="property">class </em><code class="descclassname">web.session.</code><code class="descname">Store</code></dt>
<dd><p>Base class for session stores</p>
<dl class="method">
<dt id="web.session.Store.cleanup">
<code class="descname">cleanup</code><span class="sig-paren">(</span><em>timeout</em><span class="sig-paren">)</span></dt>
<dd><p>removes all the expired sessions</p>
</dd></dl>

<dl class="method">
<dt id="web.session.Store.decode">
<code class="descname">decode</code><span class="sig-paren">(</span><em>session_data</em><span class="sig-paren">)</span></dt>
<dd><p>decodes the data to get back the session dict</p>
</dd></dl>

<dl class="method">
<dt id="web.session.Store.encode">
<code class="descname">encode</code><span class="sig-paren">(</span><em>session_dict</em><span class="sig-paren">)</span></dt>
<dd><p>encodes session dict as a string</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="web.session.DiskStore">
<em class="property">class </em><code class="descclassname">web.session.</code><code class="descname">DiskStore</code><span class="sig-paren">(</span><em>root</em><span class="sig-paren">)</span></dt>
<dd><p>Store for saving a session on disk.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tempfile</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">root</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">DiskStore</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;foo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
<span class="go">&#39;foo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">cleanup</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">KeyError</span>: <span class="n">&#39;a&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="web.session.DBStore">
<em class="property">class </em><code class="descclassname">web.session.</code><code class="descname">DBStore</code><span class="sig-paren">(</span><em>db</em>, <em>table_name</em><span class="sig-paren">)</span></dt>
<dd><p>Store for saving a session in database
Needs a table with the following columns:</p>
<blockquote>
<div>session_id CHAR(128) UNIQUE NOT NULL,
atime DATETIME NOT NULL default current_timestamp,
data TEXT</div></blockquote>
</dd></dl>

</div>
<div class="section" id="module-web.template">
<span id="web-template"></span><h2>web.template</h2>
<p>simple, elegant templating
(part of web.py)</p>
<p>Template design:</p>
<p>Template string is split into tokens and the tokens are combined into nodes. 
Parse tree is a nodelist. TextNode and ExpressionNode are simple nodes and 
for-loop, if-loop etc are block nodes, which contain multiple child nodes.</p>
<p>Each node can emit some python string. python string emitted by the 
root node is validated for safeeval and executed using python in the given environment.</p>
<p>Enough care is taken to make sure the generated code and the template has line to line match, 
so that the error messages can point to exact line number in template. (It doesn&#8217;t work in some cases still.)</p>
<p>Grammar:</p>
<blockquote>
<div><p>template -&gt; defwith sections 
defwith -&gt; &#8216;$def with (&#8216; arguments &#8216;)&#8217; | &#8216;&#8217;
sections -&gt; section*
section -&gt; block | assignment | line</p>
<p>assignment -&gt; &#8216;$ &#8216; &lt;assignment expression&gt;
line -&gt; (text|expr)*
text -&gt; &lt;any characters other than $&gt;
expr -&gt; &#8216;$&#8217; pyexpr | &#8216;$(&#8216; pyexpr &#8216;)&#8217; | &#8216;${&#8216; pyexpr &#8216;}&#8217;
pyexpr -&gt; &lt;python expression&gt;</p>
</div></blockquote>
<dl class="class">
<dt id="web.template.Render">
<em class="property">class </em><code class="descclassname">web.template.</code><code class="descname">Render</code><span class="sig-paren">(</span><em>loc='templates'</em>, <em>cache=None</em>, <em>base=None</em>, <em>**keywords</em><span class="sig-paren">)</span></dt>
<dd><p>The most preferred way of using templates.</p>
<blockquote>
<div>render = web.template.render(&#8216;templates&#8217;)
print render.foo()</div></blockquote>
<p>Optional parameter can be <cite>base</cite> can be used to pass output of 
every template through the base template.</p>
<blockquote>
<div>render = web.template.render(&#8216;templates&#8217;, base=&#8217;layout&#8217;)</div></blockquote>
</dd></dl>

<dl class="attribute">
<dt id="web.template.render">
<code class="descclassname">web.template.</code><code class="descname">render</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.template.Render" title="web.template.Render"><code class="xref py py-class docutils literal"><span class="pre">Render</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="web.template.frender">
<code class="descclassname">web.template.</code><code class="descname">frender</code><span class="sig-paren">(</span><em>path</em>, <em>**keywords</em><span class="sig-paren">)</span></dt>
<dd><p>Creates a template from the given file path.</p>
</dd></dl>

<dl class="exception">
<dt id="web.template.SecurityError">
<em class="property">exception </em><code class="descclassname">web.template.</code><code class="descname">SecurityError</code></dt>
<dd><p>The template seems to be trying to do something naughty.</p>
</dd></dl>

<dl class="function">
<dt id="web.template.test">
<code class="descclassname">web.template.</code><code class="descname">test</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Doctest for testing template module.</p>
<p>Define a utility function to run template test.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">TestResult</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">t</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span> <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">unicode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">)</span> <span class="k">if</span> <span class="n">PY2</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">t</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="o">**</span><span class="n">keywords</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">tmpl</span> <span class="o">=</span> <span class="n">Template</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="o">**</span><span class="n">keywords</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">:</span> <span class="n">TestResult</span><span class="p">(</span><span class="n">tmpl</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">))</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>Simple tests.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)()</span>
<span class="go">u&#39;1\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$def with ()</span><span class="se">\n</span><span class="s1">1&#39;</span><span class="p">)()</span>
<span class="go">u&#39;1\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$def with (a)</span><span class="se">\n</span><span class="s1">$a&#39;</span><span class="p">)(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">u&#39;1\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$def with (a=0)</span><span class="se">\n</span><span class="s1">$a&#39;</span><span class="p">)(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">u&#39;1\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$def with (a=0)</span><span class="se">\n</span><span class="s1">$a&#39;</span><span class="p">)(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">u&#39;1\n&#39;</span>
</pre></div>
</div>
<p>Test complicated expressions.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$def with (x)</span><span class="se">\n</span><span class="s1">$x.upper()&#39;</span><span class="p">)(</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>
<span class="go">u&#39;HELLO\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$(2 * 3 + 4 * 5)&#39;</span><span class="p">)()</span>
<span class="go">u&#39;26\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;${2 * 3 + 4 * 5}&#39;</span><span class="p">)()</span>
<span class="go">u&#39;26\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$def with (limit)</span><span class="se">\n</span><span class="s1">keep $(limit)ing.&#39;</span><span class="p">)(</span><span class="s1">&#39;go&#39;</span><span class="p">)</span>
<span class="go">u&#39;keep going.\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$def with (a)</span><span class="se">\n</span><span class="s1">$a.b[0]&#39;</span><span class="p">)(</span><span class="n">storage</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">u&#39;1\n&#39;</span>
</pre></div>
</div>
<p>Test html escaping.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$def with (x)</span><span class="se">\n</span><span class="s1">$x&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;a.html&#39;</span><span class="p">)(</span><span class="s1">&#39;&lt;html&gt;&#39;</span><span class="p">)</span>
<span class="go">u&#39;&amp;lt;html&amp;gt;\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$def with (x)</span><span class="se">\n</span><span class="s1">$x&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;a.txt&#39;</span><span class="p">)(</span><span class="s1">&#39;&lt;html&gt;&#39;</span><span class="p">)</span>
<span class="go">u&#39;&lt;html&gt;\n&#39;</span>
</pre></div>
</div>
<p>Test if, for and while.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$if 1: 1&#39;</span><span class="p">)()</span>
<span class="go">u&#39;1\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$if 1:</span><span class="se">\n</span><span class="s1">    1&#39;</span><span class="p">)()</span>
<span class="go">u&#39;1\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$if 1:</span><span class="se">\n</span><span class="s1">    1</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">)()</span>
<span class="go">u&#39;1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$if 0: 0</span><span class="se">\n</span><span class="s1">$elif 1: 1&#39;</span><span class="p">)()</span>
<span class="go">u&#39;1\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$if 0: 0</span><span class="se">\n</span><span class="s1">$elif None: 0</span><span class="se">\n</span><span class="s1">$else: 1&#39;</span><span class="p">)()</span>
<span class="go">u&#39;1\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$if 0 &lt; 1 and 1 &lt; 2: 1&#39;</span><span class="p">)()</span>
<span class="go">u&#39;1\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$for x in [1, 2, 3]: $x&#39;</span><span class="p">)()</span>
<span class="go">u&#39;1\n2\n3\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$def with (d)</span><span class="se">\n</span><span class="s1">$for k, v in d.items(): $k&#39;</span><span class="p">)({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="go">u&#39;1\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$for x in [1, 2, 3]:</span><span class="se">\n\t</span><span class="s1">$x&#39;</span><span class="p">)()</span>
<span class="go">u&#39;    1\n    2\n    3\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$def with (a)</span><span class="se">\n</span><span class="s1">$while a and a.pop():1&#39;</span><span class="p">)([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="go">u&#39;1\n1\n1\n&#39;</span>
</pre></div>
</div>
<p>The space after : must be ignored.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$if True: foo&#39;</span><span class="p">)()</span>
<span class="go">u&#39;foo\n&#39;</span>
</pre></div>
</div>
<p>Test loop.xxx.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s2">&quot;$for i in range(5):$loop.index, $loop.parity&quot;</span><span class="p">)()</span>
<span class="go">u&#39;1, odd\n2, even\n3, odd\n4, even\n5, odd\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s2">&quot;$for i in range(2):</span><span class="se">\n</span><span class="s2">    $for j in range(2):$loop.parent.parity $loop.parity&quot;</span><span class="p">)()</span>
<span class="go">u&#39;odd odd\nodd even\neven odd\neven even\n&#39;</span>
</pre></div>
</div>
<p>Test assignment.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$ a = 1</span><span class="se">\n</span><span class="s1">$a&#39;</span><span class="p">)()</span>
<span class="go">u&#39;1\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$ a = [1]</span><span class="se">\n</span><span class="s1">$a[0]&#39;</span><span class="p">)()</span>
<span class="go">u&#39;1\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$ a = {1: 1}</span><span class="se">\n</span><span class="s1">$list(a.keys())[0]&#39;</span><span class="p">)()</span>
<span class="go">u&#39;1\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$ a = []</span><span class="se">\n</span><span class="s1">$if not a: 1&#39;</span><span class="p">)()</span>
<span class="go">u&#39;1\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$ a = {}</span><span class="se">\n</span><span class="s1">$if not a: 1&#39;</span><span class="p">)()</span>
<span class="go">u&#39;1\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$ a = -1</span><span class="se">\n</span><span class="s1">$a&#39;</span><span class="p">)()</span>
<span class="go">u&#39;-1\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$ a = &quot;1&quot;</span><span class="se">\n</span><span class="s1">$a&#39;</span><span class="p">)()</span>
<span class="go">u&#39;1\n&#39;</span>
</pre></div>
</div>
<p>Test comments.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$# 0&#39;</span><span class="p">)()</span>
<span class="go">u&#39;\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;hello$#comment1</span><span class="se">\n</span><span class="s1">hello$#comment2&#39;</span><span class="p">)()</span>
<span class="go">u&#39;hello\nhello\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$#comment0</span><span class="se">\n</span><span class="s1">hello$#comment1</span><span class="se">\n</span><span class="s1">hello$#comment2&#39;</span><span class="p">)()</span>
<span class="go">u&#39;\nhello\nhello\n&#39;</span>
</pre></div>
</div>
<p>Test unicode.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$def with (a)</span><span class="se">\n</span><span class="s1">$a&#39;</span><span class="p">)(</span><span class="s1">u&#39;</span><span class="se">\u203d</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="go">u&#39;\u203d\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">u&#39;$def with (a)</span><span class="se">\n</span><span class="s1">$a $:a&#39;</span><span class="p">)(</span><span class="s1">u&#39;</span><span class="se">\u203d</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="go">u&#39;\u203d \u203d\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">u&#39;$def with ()</span><span class="se">\n</span><span class="s1">foo&#39;</span><span class="p">)()</span>
<span class="go">u&#39;foo\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">u&#39;$def with (f)</span><span class="se">\n</span><span class="s1">$:f(&quot;x&quot;)&#39;</span><span class="p">)(</span><span class="n">f</span><span class="p">)</span>
<span class="go">u&#39;x\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$def with (f)</span><span class="se">\n</span><span class="s1">$:f(&quot;x&quot;)&#39;</span><span class="p">)(</span><span class="n">f</span><span class="p">)</span>
<span class="go">u&#39;x\n&#39;</span>
</pre></div>
</div>
<p>Test dollar escaping.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s2">&quot;Stop, $$money isn&#39;t evaluated.&quot;</span><span class="p">)()</span>
<span class="go">u&quot;Stop, $money isn&#39;t evaluated.\n&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s2">&quot;Stop, \$money isn&#39;t evaluated.&quot;</span><span class="p">)()</span>
<span class="go">u&quot;Stop, $money isn&#39;t evaluated.\n&quot;</span>
</pre></div>
</div>
<p>Test space sensitivity.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$def with (x)</span><span class="se">\n</span><span class="s1">$x&#39;</span><span class="p">)(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">u&#39;1\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$def with(x ,y)</span><span class="se">\n</span><span class="s1">$x&#39;</span><span class="p">)(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">u&#39;1\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$(1 + 2*3 + 4)&#39;</span><span class="p">)()</span>
<span class="go">u&#39;11\n&#39;</span>
</pre></div>
</div>
<p>Make sure globals are working.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$x&#39;</span><span class="p">)()</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">NameError</span>: <span class="n">global name &#39;x&#39; is not defined</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$x&#39;</span><span class="p">,</span> <span class="nb">globals</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})()</span>
<span class="go">u&#39;1\n&#39;</span>
</pre></div>
</div>
<p>Can&#8217;t change globals.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$ x = 2</span><span class="se">\n</span><span class="s1">$x&#39;</span><span class="p">,</span> <span class="nb">globals</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})()</span>
<span class="go">u&#39;2\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$ x = x + 1</span><span class="se">\n</span><span class="s1">$x&#39;</span><span class="p">,</span> <span class="nb">globals</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})()</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">UnboundLocalError</span>: <span class="n">local variable &#39;x&#39; referenced before assignment</span>
</pre></div>
</div>
<p>Make sure builtins are customizable.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$min(1, 2)&#39;</span><span class="p">)()</span>
<span class="go">u&#39;1\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$min(1, 2)&#39;</span><span class="p">,</span> <span class="n">builtins</span><span class="o">=</span><span class="p">{})()</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">NameError</span>: <span class="n">global name &#39;min&#39; is not defined</span>
</pre></div>
</div>
<p>Test vars.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="s1">&#39;$var x: 1&#39;</span><span class="p">)()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">x</span>
<span class="go">u&#39;1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="s1">&#39;$var x = 1&#39;</span><span class="p">)()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">x</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="s1">&#39;$var x:  </span><span class="se">\n</span><span class="s1">    foo</span><span class="se">\n</span><span class="s1">    bar&#39;</span><span class="p">)()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">x</span>
<span class="go">u&#39;foo\nbar\n&#39;</span>
</pre></div>
</div>
<p>Test BOM chars.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\xef\xbb\xbf</span><span class="s1">$def with(x)</span><span class="se">\n</span><span class="s1">$x&#39;</span><span class="p">)(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
<span class="go">u&#39;foo\n&#39;</span>
</pre></div>
</div>
<p>Test for with weird cases.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s1">&#39;$for i in range(10)[1:5]:</span><span class="se">\n</span><span class="s1">    $i&#39;</span><span class="p">)()</span>
<span class="go">u&#39;1\n2\n3\n4\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s2">&quot;$for k, v in sorted({&#39;a&#39;: 1, &#39;b&#39;: 2}.items()):</span><span class="se">\n</span><span class="s2">    $k $v&quot;</span><span class="p">,</span> <span class="nb">globals</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;sorted&#39;</span><span class="p">:</span><span class="nb">sorted</span><span class="p">})()</span>
<span class="go">u&#39;a 1\nb 2\n&#39;</span>
</pre></div>
</div>
<p>Test for syntax error.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">t</span><span class="p">(</span><span class="s2">&quot;$for k, v in ({&#39;a&#39;: 1, &#39;b&#39;: 2}.items():</span><span class="se">\n</span><span class="s2">    $k $v&quot;</span><span class="p">)()</span>
<span class="gp">... </span><span class="k">except</span> <span class="ne">SyntaxError</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;OK&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Expected SyntaxError&quot;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">OK</span>
</pre></div>
</div>
<p>Test datetime.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">(</span><span class="s2">&quot;$def with (date)</span><span class="se">\n</span><span class="s2">$date.strftime(&#39;%m %Y&#39;)&quot;</span><span class="p">)(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2009</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">u&#39;01 2009\n&#39;</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-web.utils">
<span id="web-utils"></span><h2>web.utils</h2>
<p>General Utilities
(part of web.py)</p>
<dl class="class">
<dt id="web.utils.Storage">
<em class="property">class </em><code class="descclassname">web.utils.</code><code class="descname">Storage</code></dt>
<dd><p>A Storage object is like a dictionary except <cite>obj.foo</cite> can be used
in addition to <cite>obj[&#8216;foo&#8217;]</cite>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">o</span> <span class="o">=</span> <span class="n">storage</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o</span><span class="o">.</span><span class="n">a</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">o</span><span class="o">.</span><span class="n">a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o</span><span class="o">.</span><span class="n">a</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">AttributeError</span>: <span class="n">&#39;a&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="web.utils.storage">
<code class="descclassname">web.utils.</code><code class="descname">storage</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.utils.Storage" title="web.utils.Storage"><code class="xref py py-class docutils literal"><span class="pre">Storage</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="web.utils.storify">
<code class="descclassname">web.utils.</code><code class="descname">storify</code><span class="sig-paren">(</span><em>mapping</em>, <em>*requireds</em>, <em>**defaults</em><span class="sig-paren">)</span></dt>
<dd><p>Creates a <cite>storage</cite> object from dictionary <cite>mapping</cite>, raising <cite>KeyError</cite> if
d doesn&#8217;t have all of the keys in <cite>requireds</cite> and using the default 
values for keys found in <cite>defaults</cite>.</p>
<p>For example, <cite>storify({&#8216;a&#8217;:1, &#8216;c&#8217;:3}, b=2, c=0)</cite> will return the equivalent of
<cite>storage({&#8216;a&#8217;:1, &#8216;b&#8217;:2, &#8216;c&#8217;:3})</cite>.</p>
<p>If a <cite>storify</cite> value is a list (e.g. multiple values in a form submission), 
<cite>storify</cite> returns the last element of the list, unless the key appears in 
<cite>defaults</cite> as a list. Thus:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">storify</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span><span class="o">.</span><span class="n">a</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">storify</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]},</span> <span class="n">a</span><span class="o">=</span><span class="p">[])</span><span class="o">.</span><span class="n">a</span>
<span class="go">[1, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">storify</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="n">a</span><span class="o">=</span><span class="p">[])</span><span class="o">.</span><span class="n">a</span>
<span class="go">[1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">storify</span><span class="p">({},</span> <span class="n">a</span><span class="o">=</span><span class="p">[])</span><span class="o">.</span><span class="n">a</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>Similarly, if the value has a <cite>value</cite> attribute, <cite>storify will return _its_
value, unless the key appears in `defaults</cite> as a dictionary.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">storify</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="n">storage</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">)})</span><span class="o">.</span><span class="n">a</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">storify</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="n">storage</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">)},</span> <span class="n">a</span><span class="o">=</span><span class="p">{})</span><span class="o">.</span><span class="n">a</span>
<span class="go">&lt;Storage {&#39;value&#39;: 1}&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">storify</span><span class="p">({},</span> <span class="n">a</span><span class="o">=</span><span class="p">{})</span><span class="o">.</span><span class="n">a</span>
<span class="go">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="web.utils.Counter">
<em class="property">class </em><code class="descclassname">web.utils.</code><code class="descname">Counter</code></dt>
<dd><p>Keeps count of how many times something is added.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">counter</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="go">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">most</span><span class="p">()</span>
<span class="go">[&#39;x&#39;]</span>
</pre></div>
</div>
<dl class="method">
<dt id="web.utils.Counter.least">
<code class="descname">least</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Returns the keys with mininum count.</p>
</dd></dl>

<dl class="method">
<dt id="web.utils.Counter.most">
<code class="descname">most</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Returns the keys with maximum count.</p>
</dd></dl>

<dl class="method">
<dt id="web.utils.Counter.percent">
<code class="descname">percent</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span></dt>
<dd><p>Returns what percentage a certain key is of all entries.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">counter</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">percent</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="go">0.75</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">percent</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="go">0.25</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="web.utils.Counter.sorted_items">
<code class="descname">sorted_items</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Returns items sorted by value.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">counter</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">sorted_items</span><span class="p">()</span>
<span class="go">[(&#39;x&#39;, 2), (&#39;y&#39;, 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="web.utils.Counter.sorted_keys">
<code class="descname">sorted_keys</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Returns keys sorted by value.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">counter</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">sorted_keys</span><span class="p">()</span>
<span class="go">[&#39;x&#39;, &#39;y&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="web.utils.Counter.sorted_values">
<code class="descname">sorted_values</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Returns values sorted by value.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">counter</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">sorted_values</span><span class="p">()</span>
<span class="go">[2, 1]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="web.utils.counter">
<code class="descclassname">web.utils.</code><code class="descname">counter</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.utils.Counter" title="web.utils.Counter"><code class="xref py py-class docutils literal"><span class="pre">Counter</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="web.utils.rstrips">
<code class="descclassname">web.utils.</code><code class="descname">rstrips</code><span class="sig-paren">(</span><em>text</em>, <em>remove</em><span class="sig-paren">)</span></dt>
<dd><p>removes the string <cite>remove</cite> from the right of <cite>text</cite></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rstrips</span><span class="p">(</span><span class="s2">&quot;foobar&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="go">&#39;foo&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.utils.lstrips">
<code class="descclassname">web.utils.</code><code class="descname">lstrips</code><span class="sig-paren">(</span><em>text</em>, <em>remove</em><span class="sig-paren">)</span></dt>
<dd><p>removes the string <cite>remove</cite> from the left of <cite>text</cite></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lstrips</span><span class="p">(</span><span class="s2">&quot;foobar&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">)</span>
<span class="go">&#39;bar&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lstrips</span><span class="p">(</span><span class="s1">&#39;http://foo.org/&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;http://&#39;</span><span class="p">,</span> <span class="s1">&#39;https://&#39;</span><span class="p">])</span>
<span class="go">&#39;foo.org/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lstrips</span><span class="p">(</span><span class="s1">&#39;FOOBARBAZ&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;FOO&#39;</span><span class="p">,</span> <span class="s1">&#39;BAR&#39;</span><span class="p">])</span>
<span class="go">&#39;BAZ&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lstrips</span><span class="p">(</span><span class="s1">&#39;FOOBARBAZ&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;BAR&#39;</span><span class="p">,</span> <span class="s1">&#39;FOO&#39;</span><span class="p">])</span>
<span class="go">&#39;BARBAZ&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.utils.strips">
<code class="descclassname">web.utils.</code><code class="descname">strips</code><span class="sig-paren">(</span><em>text</em>, <em>remove</em><span class="sig-paren">)</span></dt>
<dd><p>removes the string <cite>remove</cite> from the both sides of <cite>text</cite></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">strips</span><span class="p">(</span><span class="s2">&quot;foobarfoo&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">)</span>
<span class="go">&#39;bar&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.utils.safeunicode">
<code class="descclassname">web.utils.</code><code class="descname">safeunicode</code><span class="sig-paren">(</span><em>obj</em>, <em>encoding='utf-8'</em><span class="sig-paren">)</span></dt>
<dd><p>Converts any given object to unicode string.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">safeunicode</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>
<span class="go">u&#39;hello&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">safeunicode</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">u&#39;2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">safeunicode</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\xe1\x88\xb4</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="go">u&#39;\u1234&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.utils.safestr">
<code class="descclassname">web.utils.</code><code class="descname">safestr</code><span class="sig-paren">(</span><em>obj</em>, <em>encoding='utf-8'</em><span class="sig-paren">)</span></dt>
<dd><p>Converts any given object to utf-8 encoded string.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">safestr</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>
<span class="go">&#39;hello&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">safestr</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">&#39;2&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.utils.timelimit">
<code class="descclassname">web.utils.</code><code class="descname">timelimit</code><span class="sig-paren">(</span><em>timeout</em><span class="sig-paren">)</span></dt>
<dd><p>A decorator to limit a function to <cite>timeout</cite> seconds, raising <cite>TimeoutError</cite>
if it takes longer.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">meaningoflife</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="o">.</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="mi">42</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">timelimit</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">)(</span><span class="n">meaningoflife</span><span class="p">)()</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">RuntimeError</span>: <span class="n">took too long</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">timelimit</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">meaningoflife</span><span class="p">)()</span>
<span class="go">42</span>
</pre></div>
</div>
<p>_Caveat:_ The function isn&#8217;t stopped after <cite>timeout</cite> seconds but continues 
executing in a separate thread. (There seems to be no way to kill a thread.)</p>
<p>inspired by &lt;<a class="reference external" href="http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/473878">http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/473878</a>&gt;</p>
</dd></dl>

<dl class="class">
<dt id="web.utils.Memoize">
<em class="property">class </em><code class="descclassname">web.utils.</code><code class="descname">Memoize</code><span class="sig-paren">(</span><em>func</em>, <em>expires=None</em>, <em>background=True</em><span class="sig-paren">)</span></dt>
<dd><p>&#8216;Memoizes&#8217; a function, caching its return values for each input.
If <cite>expires</cite> is specified, values are recalculated after <cite>expires</cite> seconds.
If <cite>background</cite> is specified, values are recalculated in a separate thread.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calls</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">howmanytimeshaveibeencalled</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">global</span> <span class="n">calls</span>
<span class="gp">... </span>    <span class="n">calls</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">calls</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fastcalls</span> <span class="o">=</span> <span class="n">memoize</span><span class="p">(</span><span class="n">howmanytimeshaveibeencalled</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">howmanytimeshaveibeencalled</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">howmanytimeshaveibeencalled</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fastcalls</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fastcalls</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fastcalls</span> <span class="o">=</span> <span class="n">memoize</span><span class="p">(</span><span class="n">howmanytimeshaveibeencalled</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fastcalls</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fastcalls</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="o">.</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fastcalls</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">slowfunc</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">howmanytimeshaveibeencalled</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fastcalls</span> <span class="o">=</span> <span class="n">memoize</span><span class="p">(</span><span class="n">slowfunc</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fastcalls</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">timelimit</span><span class="p">(</span><span class="o">.</span><span class="mo">05</span><span class="p">)(</span><span class="n">fastcalls</span><span class="p">)()</span>
<span class="go">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="o">.</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">timelimit</span><span class="p">(</span><span class="o">.</span><span class="mo">05</span><span class="p">)(</span><span class="n">fastcalls</span><span class="p">)()</span>
<span class="go">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">timelimit</span><span class="p">(</span><span class="o">.</span><span class="mo">05</span><span class="p">)(</span><span class="n">fastcalls</span><span class="p">)()</span>
<span class="go">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="o">.</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">timelimit</span><span class="p">(</span><span class="o">.</span><span class="mo">05</span><span class="p">)(</span><span class="n">fastcalls</span><span class="p">)()</span>
<span class="go">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fastcalls</span> <span class="o">=</span> <span class="n">memoize</span><span class="p">(</span><span class="n">slowfunc</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">fastcalls</span><span class="p">)</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="o">.</span><span class="mo">01</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fastcalls</span><span class="p">()</span>
<span class="go">9</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="web.utils.memoize">
<code class="descclassname">web.utils.</code><code class="descname">memoize</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.utils.Memoize" title="web.utils.Memoize"><code class="xref py py-class docutils literal"><span class="pre">Memoize</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="web.utils.re_subm">
<code class="descclassname">web.utils.</code><code class="descname">re_subm</code><span class="sig-paren">(</span><em>pat</em>, <em>repl</em>, <em>string</em><span class="sig-paren">)</span></dt>
<dd><p>Like re.sub, but returns the replacement _and_ the match object.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">re_subm</span><span class="p">(</span><span class="s1">&#39;g(oo+)fball&#39;</span><span class="p">,</span> <span class="s1">r&#39;f\1lish&#39;</span><span class="p">,</span> <span class="s1">&#39;goooooofball&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go">&#39;foooooolish&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
<span class="go">(&#39;oooooo&#39;,)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.utils.group">
<code class="descclassname">web.utils.</code><code class="descname">group</code><span class="sig-paren">(</span><em>seq</em>, <em>size</em><span class="sig-paren">)</span></dt>
<dd><p>Returns an iterator over a series of lists of length size from iterable.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">group</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">[[1, 2], [3, 4]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">group</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">[[1, 2], [3, 4], [5]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.utils.uniq">
<code class="descclassname">web.utils.</code><code class="descname">uniq</code><span class="sig-paren">(</span><em>seq</em>, <em>key=None</em><span class="sig-paren">)</span></dt>
<dd><p>Removes duplicate elements from a list while preserving the order of the rest.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">uniq</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[9, 0, 2, 1]</span>
</pre></div>
</div>
<p>The value of the optional <cite>key</cite> parameter should be a function that
takes a single argument and returns a key to test the uniqueness.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">uniq</span><span class="p">([</span><span class="s2">&quot;Foo&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
<span class="go">[&#39;Foo&#39;, &#39;bar&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.utils.iterview">
<code class="descclassname">web.utils.</code><code class="descname">iterview</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span></dt>
<dd><p>Takes an iterable <cite>x</cite> and returns an iterator over it
which prints its progress to stderr as it iterates through.</p>
</dd></dl>

<dl class="class">
<dt id="web.utils.IterBetter">
<em class="property">class </em><code class="descclassname">web.utils.</code><code class="descname">IterBetter</code><span class="sig-paren">(</span><em>iterator</em><span class="sig-paren">)</span></dt>
<dd><p>Returns an object that can be used as an iterator 
but can also be used via __getitem__ (although it 
cannot go backwards &#8211; that is, you cannot request 
<cite>iterbetter[0]</cite> after requesting <cite>iterbetter[1]</cite>).</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">itertools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">iterbetter</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
<span class="go">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">IndexError</span>: <span class="n">already passed 3</span>
</pre></div>
</div>
<p>It is also possible to get the first value of the iterator or None.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">iterbetter</span><span class="p">(</span><span class="nb">iter</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">first</span><span class="p">())</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">iterbetter</span><span class="p">(</span><span class="nb">iter</span><span class="p">([]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">first</span><span class="p">())</span>
<span class="go">None</span>
</pre></div>
</div>
<p>For boolean test, IterBetter peeps at first value in the itertor without effecting the iteration.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">iterbetter</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">bool</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">[0, 1, 2, 3, 4]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">iterbetter</span><span class="p">(</span><span class="nb">iter</span><span class="p">([]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">bool</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
<dl class="method">
<dt id="web.utils.IterBetter.first">
<code class="descname">first</code><span class="sig-paren">(</span><em>default=None</em><span class="sig-paren">)</span></dt>
<dd><p>Returns the first element of the iterator or None when there are no
elements.</p>
<p>If the optional argument default is specified, that is returned instead
of None when there are no elements.</p>
</dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="web.utils.iterbetter">
<code class="descclassname">web.utils.</code><code class="descname">iterbetter</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.utils.IterBetter" title="web.utils.IterBetter"><code class="xref py py-class docutils literal"><span class="pre">IterBetter</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="web.utils.safeiter">
<code class="descclassname">web.utils.</code><code class="descname">safeiter</code><span class="sig-paren">(</span><em>it</em>, <em>cleanup=None</em>, <em>ignore_errors=True</em><span class="sig-paren">)</span></dt>
<dd><p>Makes an iterator safe by ignoring the exceptions occured during the iteration.</p>
</dd></dl>

<dl class="function">
<dt id="web.utils.safewrite">
<code class="descclassname">web.utils.</code><code class="descname">safewrite</code><span class="sig-paren">(</span><em>filename</em>, <em>content</em><span class="sig-paren">)</span></dt>
<dd><p>Writes the content to a temp file and then moves the temp file to 
given filename to avoid overwriting the existing file in case of errors.</p>
</dd></dl>

<dl class="function">
<dt id="web.utils.dictreverse">
<code class="descclassname">web.utils.</code><code class="descname">dictreverse</code><span class="sig-paren">(</span><em>mapping</em><span class="sig-paren">)</span></dt>
<dd><p>Returns a new dictionary with keys and values swapped.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dictreverse</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">4</span><span class="p">})</span>
<span class="go">{2: 1, 4: 3}</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.utils.dictfind">
<code class="descclassname">web.utils.</code><code class="descname">dictfind</code><span class="sig-paren">(</span><em>dictionary</em>, <em>element</em><span class="sig-paren">)</span></dt>
<dd><p>Returns a key whose value in <cite>dictionary</cite> is <cite>element</cite> 
or, if none exists, None.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dictfind</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dictfind</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.utils.dictfindall">
<code class="descclassname">web.utils.</code><code class="descname">dictfindall</code><span class="sig-paren">(</span><em>dictionary</em>, <em>element</em><span class="sig-paren">)</span></dt>
<dd><p>Returns the keys whose values in <cite>dictionary</cite> are <cite>element</cite>
or, if none exists, [].</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dictfindall</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">[1, 3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dictfindall</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.utils.dictincr">
<code class="descclassname">web.utils.</code><code class="descname">dictincr</code><span class="sig-paren">(</span><em>dictionary</em>, <em>element</em><span class="sig-paren">)</span></dt>
<dd><p>Increments <cite>element</cite> in <cite>dictionary</cite>, 
setting it to one if it doesn&#8217;t exist.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dictincr</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dictincr</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.utils.dictadd">
<code class="descclassname">web.utils.</code><code class="descname">dictadd</code><span class="sig-paren">(</span><em>*dicts</em><span class="sig-paren">)</span></dt>
<dd><p>Returns a dictionary consisting of the keys in the argument dictionaries.
If they share a key, the value from the last argument is used.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dictadd</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="go">{1: 0, 2: 1, 3: 1}</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.utils.requeue">
<code class="descclassname">web.utils.</code><code class="descname">requeue</code><span class="sig-paren">(</span><em>queue</em>, <em>index=-1</em><span class="sig-paren">)</span></dt>
<dd><p>Returns the element at index after moving it to the beginning of the queue.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">requeue</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">[4, 1, 2, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.utils.restack">
<code class="descclassname">web.utils.</code><code class="descname">restack</code><span class="sig-paren">(</span><em>stack</em>, <em>index=0</em><span class="sig-paren">)</span></dt>
<dd><p>Returns the element at index after moving it to the top of stack.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">restack</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">[2, 3, 4, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.utils.listget">
<code class="descclassname">web.utils.</code><code class="descname">listget</code><span class="sig-paren">(</span><em>lst</em>, <em>ind</em>, <em>default=None</em><span class="sig-paren">)</span></dt>
<dd><p>Returns <cite>lst[ind]</cite> if it exists, <cite>default</cite> otherwise.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">listget</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">&#39;a&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">listget</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">listget</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">&#39;b&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.utils.intget">
<code class="descclassname">web.utils.</code><code class="descname">intget</code><span class="sig-paren">(</span><em>integer</em>, <em>default=None</em><span class="sig-paren">)</span></dt>
<dd><p>Returns <cite>integer</cite> as an int or <cite>default</cite> if it can&#8217;t.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">intget</span><span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intget</span><span class="p">(</span><span class="s1">&#39;3a&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intget</span><span class="p">(</span><span class="s1">&#39;3a&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.utils.datestr">
<code class="descclassname">web.utils.</code><code class="descname">datestr</code><span class="sig-paren">(</span><em>then</em>, <em>now=None</em><span class="sig-paren">)</span></dt>
<dd><p>Converts a (UTC) datetime object to a nice string representation.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">1970</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">datestr</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">now</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
<span class="go">&#39;0 microseconds ago&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">({</span>
<span class="gp">... </span>  <span class="n">timedelta</span><span class="p">(</span><span class="n">microseconds</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span> <span class="s1">&#39;1 microsecond ago&#39;</span><span class="p">,</span>
<span class="gp">... </span>  <span class="n">timedelta</span><span class="p">(</span><span class="n">microseconds</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span> <span class="s1">&#39;2 microseconds ago&#39;</span><span class="p">,</span>
<span class="gp">... </span>  <span class="o">-</span><span class="n">timedelta</span><span class="p">(</span><span class="n">microseconds</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span> <span class="s1">&#39;1 microsecond from now&#39;</span><span class="p">,</span>
<span class="gp">... </span>  <span class="o">-</span><span class="n">timedelta</span><span class="p">(</span><span class="n">microseconds</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span> <span class="s1">&#39;2 microseconds from now&#39;</span><span class="p">,</span>
<span class="gp">... </span>  <span class="n">timedelta</span><span class="p">(</span><span class="n">microseconds</span><span class="o">=</span><span class="mi">2000</span><span class="p">):</span> <span class="s1">&#39;2 milliseconds ago&#39;</span><span class="p">,</span>
<span class="gp">... </span>  <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span> <span class="s1">&#39;2 seconds ago&#39;</span><span class="p">,</span>
<span class="gp">... </span>  <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="mi">60</span><span class="p">):</span> <span class="s1">&#39;2 minutes ago&#39;</span><span class="p">,</span>
<span class="gp">... </span>  <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="p">):</span> <span class="s1">&#39;2 hours ago&#39;</span><span class="p">,</span>
<span class="gp">... </span>  <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span> <span class="s1">&#39;2 days ago&#39;</span><span class="p">,</span>
<span class="gp">... </span><span class="p">}):</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">datestr</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">now</span><span class="o">=</span><span class="n">d</span><span class="o">+</span><span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="n">v</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">datestr</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1970</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">now</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
<span class="go">&#39;January  1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">datestr</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1969</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">now</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
<span class="go">&#39;January  1, 1969&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">datestr</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1970</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">now</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
<span class="go">&#39;June  1, 1970&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">datestr</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
<span class="go">&#39;&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.utils.numify">
<code class="descclassname">web.utils.</code><code class="descname">numify</code><span class="sig-paren">(</span><em>string</em><span class="sig-paren">)</span></dt>
<dd><p>Removes all non-digit characters from <cite>string</cite>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">numify</span><span class="p">(</span><span class="s1">&#39;800-555-1212&#39;</span><span class="p">)</span>
<span class="go">&#39;8005551212&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numify</span><span class="p">(</span><span class="s1">&#39;800.555.1212&#39;</span><span class="p">)</span>
<span class="go">&#39;8005551212&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.utils.denumify">
<code class="descclassname">web.utils.</code><code class="descname">denumify</code><span class="sig-paren">(</span><em>string</em>, <em>pattern</em><span class="sig-paren">)</span></dt>
<dd><p>Formats <cite>string</cite> according to <cite>pattern</cite>, where the letter X gets replaced
by characters from <cite>string</cite>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">denumify</span><span class="p">(</span><span class="s2">&quot;8005551212&quot;</span><span class="p">,</span> <span class="s2">&quot;(XXX) XXX-XXXX&quot;</span><span class="p">)</span>
<span class="go">&#39;(800) 555-1212&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.utils.commify">
<code class="descclassname">web.utils.</code><code class="descname">commify</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span></dt>
<dd><p>Add commas to an integer <cite>n</cite>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">commify</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&#39;1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">commify</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="go">&#39;123&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">commify</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span>
<span class="go">&#39;1,234&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">commify</span><span class="p">(</span><span class="mi">1234567890</span><span class="p">)</span>
<span class="go">&#39;1,234,567,890&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">commify</span><span class="p">(</span><span class="mf">123.0</span><span class="p">)</span>
<span class="go">&#39;123.0&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">commify</span><span class="p">(</span><span class="mf">1234.5</span><span class="p">)</span>
<span class="go">&#39;1,234.5&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">commify</span><span class="p">(</span><span class="mf">1234.56789</span><span class="p">)</span>
<span class="go">&#39;1,234.56789&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">commify</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="mf">1234.5</span><span class="p">)</span>
<span class="go">&#39;1,234.50&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">commify</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.utils.dateify">
<code class="descclassname">web.utils.</code><code class="descname">dateify</code><span class="sig-paren">(</span><em>datestring</em><span class="sig-paren">)</span></dt>
<dd><p>Formats a numified <cite>datestring</cite> properly.</p>
</dd></dl>

<dl class="function">
<dt id="web.utils.nthstr">
<code class="descclassname">web.utils.</code><code class="descname">nthstr</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span></dt>
<dd><p>Formats an ordinal.
Doesn&#8217;t handle negative numbers.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nthstr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&#39;1st&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nthstr</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">&#39;0th&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">nthstr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">]]</span>
<span class="go">[&#39;2nd&#39;, &#39;3rd&#39;, &#39;4th&#39;, &#39;5th&#39;, &#39;10th&#39;, &#39;11th&#39;, &#39;12th&#39;, &#39;13th&#39;, &#39;14th&#39;, &#39;15th&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">nthstr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">91</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">93</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">102</span><span class="p">]]</span>
<span class="go">[&#39;91st&#39;, &#39;92nd&#39;, &#39;93rd&#39;, &#39;94th&#39;, &#39;99th&#39;, &#39;100th&#39;, &#39;101st&#39;, &#39;102nd&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">nthstr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">111</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">115</span><span class="p">]]</span>
<span class="go">[&#39;111th&#39;, &#39;112th&#39;, &#39;113th&#39;, &#39;114th&#39;, &#39;115th&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.utils.cond">
<code class="descclassname">web.utils.</code><code class="descname">cond</code><span class="sig-paren">(</span><em>predicate</em>, <em>consequence</em>, <em>alternative=None</em><span class="sig-paren">)</span></dt>
<dd><p>Function replacement for if-else to use in expressions.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cond</span><span class="p">(</span><span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;even&quot;</span><span class="p">,</span> <span class="s2">&quot;odd&quot;</span><span class="p">)</span>
<span class="go">&#39;even&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cond</span><span class="p">(</span><span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;even&quot;</span><span class="p">,</span> <span class="s2">&quot;odd&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_row&#39;</span>
<span class="go">&#39;even_row&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="web.utils.CaptureStdout">
<em class="property">class </em><code class="descclassname">web.utils.</code><code class="descname">CaptureStdout</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span></dt>
<dd><p>Captures everything <cite>func</cite> prints to stdout and returns it instead.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">idiot</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">capturestdout</span><span class="p">(</span><span class="n">idiot</span><span class="p">)()</span>
<span class="go">&#39;foo\n&#39;</span>
</pre></div>
</div>
<p><strong>WARNING:</strong> Not threadsafe!</p>
</dd></dl>

<dl class="attribute">
<dt id="web.utils.capturestdout">
<code class="descclassname">web.utils.</code><code class="descname">capturestdout</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.utils.CaptureStdout" title="web.utils.CaptureStdout"><code class="xref py py-class docutils literal"><span class="pre">CaptureStdout</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="web.utils.Profile">
<em class="property">class </em><code class="descclassname">web.utils.</code><code class="descname">Profile</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span></dt>
<dd><p>Profiles <cite>func</cite> and returns a tuple containing its output
and a string with human-readable profiling information.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span><span class="p">,</span> <span class="n">inf</span> <span class="o">=</span> <span class="n">profile</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">)(</span><span class="o">.</span><span class="mo">001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inf</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="go">&#39;took 0.0&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="web.utils.profile">
<code class="descclassname">web.utils.</code><code class="descname">profile</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.utils.Profile" title="web.utils.Profile"><code class="xref py py-class docutils literal"><span class="pre">Profile</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="web.utils.tryall">
<code class="descclassname">web.utils.</code><code class="descname">tryall</code><span class="sig-paren">(</span><em>context</em>, <em>prefix=None</em><span class="sig-paren">)</span></dt>
<dd><p>Tries a series of functions and prints their results. 
<cite>context</cite> is a dictionary mapping names to values; 
the value will only be tried if it&#8217;s callable.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tryall</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">True</span><span class="p">))</span>
<span class="go">j: True</span>
<span class="go">----------------------------------------</span>
<span class="go">results:</span>
<span class="go">   True: 1</span>
</pre></div>
</div>
<p>For example, you might have a file <cite>test/stuff.py</cite> 
with a series of functions testing various things in it. 
At the bottom, have a line:</p>
<blockquote>
<div>if __name__ == &#8220;__main__&#8221;: tryall(globals())</div></blockquote>
<p>Then you can run <cite>python test/stuff.py</cite> and get the results of 
all the tests.</p>
</dd></dl>

<dl class="class">
<dt id="web.utils.ThreadedDict">
<em class="property">class </em><code class="descclassname">web.utils.</code><code class="descname">ThreadedDict</code></dt>
<dd><p>Thread local storage.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">ThreadedDict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">x</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">threading</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">():</span> <span class="n">d</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">x</span>
<span class="go">1</span>
</pre></div>
</div>
<dl class="staticmethod">
<dt id="web.utils.ThreadedDict.clear_all">
<em class="property">static </em><code class="descname">clear_all</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Clears all ThreadedDict instances.</p>
</dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="web.utils.threadeddict">
<code class="descclassname">web.utils.</code><code class="descname">threadeddict</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.utils.ThreadedDict" title="web.utils.ThreadedDict"><code class="xref py py-class docutils literal"><span class="pre">ThreadedDict</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="web.utils.autoassign">
<code class="descclassname">web.utils.</code><code class="descname">autoassign</code><span class="sig-paren">(</span><em>self</em>, <em>locals</em><span class="sig-paren">)</span></dt>
<dd><p>Automatically assigns local variables to <cite>self</cite>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">storage</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">autoassign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">a</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">b</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Generally used in <cite>__init__</cite> methods, as in:</p>
<blockquote>
<div>def __init__(self, foo, bar, baz=1): autoassign(self, locals())</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="web.utils.to36">
<code class="descclassname">web.utils.</code><code class="descname">to36</code><span class="sig-paren">(</span><em>q</em><span class="sig-paren">)</span></dt>
<dd><p>Converts an integer to base 36 (a useful scheme for human-sayable IDs).</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">to36</span><span class="p">(</span><span class="mi">35</span><span class="p">)</span>
<span class="go">&#39;z&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">to36</span><span class="p">(</span><span class="mi">119292</span><span class="p">)</span>
<span class="go">&#39;2k1o&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">int</span><span class="p">(</span><span class="n">to36</span><span class="p">(</span><span class="mi">939387374</span><span class="p">),</span> <span class="mi">36</span><span class="p">)</span>
<span class="go">939387374</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">to36</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">&#39;0&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">to36</span><span class="p">(</span><span class="o">-</span><span class="mi">393</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span> 
<span class="gr">ValueError</span>: <span class="n">must supply a positive integer</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="web.utils.safemarkdown">
<code class="descclassname">web.utils.</code><code class="descname">safemarkdown</code><span class="sig-paren">(</span><em>text</em><span class="sig-paren">)</span></dt>
<dd><p>Converts text to HTML following the rules of Markdown, but blocking any
outside HTML input, so that only the things supported by Markdown
can be used. Also converts raw URLs to links.</p>
<p>(requires [markdown.py](<a class="reference external" href="http://webpy.org/markdown.py">http://webpy.org/markdown.py</a>))</p>
</dd></dl>

<dl class="function">
<dt id="web.utils.sendmail">
<code class="descclassname">web.utils.</code><code class="descname">sendmail</code><span class="sig-paren">(</span><em>from_address</em>, <em>to_address</em>, <em>subject</em>, <em>message</em>, <em>headers=None</em>, <em>**kw</em><span class="sig-paren">)</span></dt>
<dd><p>Sends the email message <cite>message</cite> with mail and envelope headers
for from <cite>from_address_</cite> to <cite>to_address</cite> with <cite>subject</cite>. 
Additional email headers can be specified with the dictionary 
<a href="#id1"><span class="problematic" id="id2">`</span></a>headers.</p>
<p>Optionally cc, bcc and attachments can be specified as keyword arguments.
Attachments must be an iterable and each attachment can be either a 
filename or a file object or a dictionary with filename, content and 
optionally content_type keys.</p>
<p>If <cite>web.config.smtp_server</cite> is set, it will send the message
to that SMTP server. Otherwise it will look for 
<cite>/usr/sbin/sendmail</cite>, the typical location for the sendmail-style
binary. To use sendmail from a different path, set <cite>web.config.sendmail_path</cite>.</p>
</dd></dl>

</div>
<div class="section" id="module-web.webapi">
<span id="web-webapi"></span><h2>web.webapi</h2>
<p>Web API (wrapper around WSGI)
(from web.py)</p>
<dl class="function">
<dt id="web.webapi.header">
<code class="descclassname">web.webapi.</code><code class="descname">header</code><span class="sig-paren">(</span><em>hdr</em>, <em>value</em>, <em>unique=False</em><span class="sig-paren">)</span></dt>
<dd><p>Adds the header <cite>hdr: value</cite> with the response.</p>
<p>If <cite>unique</cite> is True and a header with that name already exists,
it doesn&#8217;t add a new one.</p>
</dd></dl>

<dl class="function">
<dt id="web.webapi.debug">
<code class="descclassname">web.webapi.</code><code class="descname">debug</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span></dt>
<dd><p>Prints a prettyprinted version of <cite>args</cite> to stderr.</p>
</dd></dl>

<dl class="function">
<dt id="web.webapi.input">
<code class="descclassname">web.webapi.</code><code class="descname">input</code><span class="sig-paren">(</span><em>*requireds</em>, <em>**defaults</em><span class="sig-paren">)</span></dt>
<dd><p>Returns a <cite>storage</cite> object with the GET and POST arguments.
See <cite>storify</cite> for how <cite>requireds</cite> and <cite>defaults</cite> work.</p>
</dd></dl>

<dl class="function">
<dt id="web.webapi.data">
<code class="descclassname">web.webapi.</code><code class="descname">data</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Returns the data sent with the request.</p>
</dd></dl>

<dl class="function">
<dt id="web.webapi.setcookie">
<code class="descclassname">web.webapi.</code><code class="descname">setcookie</code><span class="sig-paren">(</span><em>name</em>, <em>value</em>, <em>expires=''</em>, <em>domain=None</em>, <em>secure=False</em>, <em>httponly=False</em>, <em>path=None</em><span class="sig-paren">)</span></dt>
<dd><p>Sets a cookie.</p>
</dd></dl>

<dl class="function">
<dt id="web.webapi.cookies">
<code class="descclassname">web.webapi.</code><code class="descname">cookies</code><span class="sig-paren">(</span><em>*requireds</em>, <em>**defaults</em><span class="sig-paren">)</span></dt>
<dd><p>Returns a <cite>storage</cite> object with all the request cookies in it.</p>
<p>See <cite>storify</cite> for how <cite>requireds</cite> and <cite>defaults</cite> work.</p>
<p>This is forgiving on bad HTTP_COOKIE input, it tries to parse at least
the cookies it can.</p>
<p>The values are converted to unicode if _unicode=True is passed.</p>
</dd></dl>

<dl class="exception">
<dt id="web.webapi.OK">
<em class="property">exception </em><code class="descclassname">web.webapi.</code><code class="descname">OK</code><span class="sig-paren">(</span><em>data=''</em>, <em>headers={}</em><span class="sig-paren">)</span></dt>
<dd><p><cite>200 OK</cite> status</p>
</dd></dl>

<dl class="exception">
<dt id="web.webapi.Created">
<em class="property">exception </em><code class="descclassname">web.webapi.</code><code class="descname">Created</code><span class="sig-paren">(</span><em>data='Created'</em>, <em>headers={}</em><span class="sig-paren">)</span></dt>
<dd><p><cite>201 Created</cite> status</p>
</dd></dl>

<dl class="exception">
<dt id="web.webapi.Accepted">
<em class="property">exception </em><code class="descclassname">web.webapi.</code><code class="descname">Accepted</code><span class="sig-paren">(</span><em>data='Accepted'</em>, <em>headers={}</em><span class="sig-paren">)</span></dt>
<dd><p><cite>202 Accepted</cite> status</p>
</dd></dl>

<dl class="exception">
<dt id="web.webapi.NoContent">
<em class="property">exception </em><code class="descclassname">web.webapi.</code><code class="descname">NoContent</code><span class="sig-paren">(</span><em>data='No Content'</em>, <em>headers={}</em><span class="sig-paren">)</span></dt>
<dd><p><cite>204 No Content</cite> status</p>
</dd></dl>

<dl class="attribute">
<dt id="web.webapi.ok">
<code class="descclassname">web.webapi.</code><code class="descname">ok</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.webapi.OK" title="web.webapi.OK"><code class="xref py py-class docutils literal"><span class="pre">OK</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="web.webapi.created">
<code class="descclassname">web.webapi.</code><code class="descname">created</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.webapi.Created" title="web.webapi.Created"><code class="xref py py-class docutils literal"><span class="pre">Created</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="web.webapi.accepted">
<code class="descclassname">web.webapi.</code><code class="descname">accepted</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.webapi.Accepted" title="web.webapi.Accepted"><code class="xref py py-class docutils literal"><span class="pre">Accepted</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="web.webapi.nocontent">
<code class="descclassname">web.webapi.</code><code class="descname">nocontent</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.webapi.NoContent" title="web.webapi.NoContent"><code class="xref py py-class docutils literal"><span class="pre">NoContent</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="web.webapi.Redirect">
<em class="property">exception </em><code class="descclassname">web.webapi.</code><code class="descname">Redirect</code><span class="sig-paren">(</span><em>url</em>, <em>status='301 Moved Permanently'</em>, <em>absolute=False</em><span class="sig-paren">)</span></dt>
<dd><p>A <cite>301 Moved Permanently</cite> redirect.</p>
</dd></dl>

<dl class="exception">
<dt id="web.webapi.Found">
<em class="property">exception </em><code class="descclassname">web.webapi.</code><code class="descname">Found</code><span class="sig-paren">(</span><em>url</em>, <em>absolute=False</em><span class="sig-paren">)</span></dt>
<dd><p>A <cite>302 Found</cite> redirect.</p>
</dd></dl>

<dl class="exception">
<dt id="web.webapi.SeeOther">
<em class="property">exception </em><code class="descclassname">web.webapi.</code><code class="descname">SeeOther</code><span class="sig-paren">(</span><em>url</em>, <em>absolute=False</em><span class="sig-paren">)</span></dt>
<dd><p>A <cite>303 See Other</cite> redirect.</p>
</dd></dl>

<dl class="exception">
<dt id="web.webapi.NotModified">
<em class="property">exception </em><code class="descclassname">web.webapi.</code><code class="descname">NotModified</code></dt>
<dd><p>A <cite>304 Not Modified</cite> status.</p>
</dd></dl>

<dl class="exception">
<dt id="web.webapi.TempRedirect">
<em class="property">exception </em><code class="descclassname">web.webapi.</code><code class="descname">TempRedirect</code><span class="sig-paren">(</span><em>url</em>, <em>absolute=False</em><span class="sig-paren">)</span></dt>
<dd><p>A <cite>307 Temporary Redirect</cite> redirect.</p>
</dd></dl>

<dl class="attribute">
<dt id="web.webapi.redirect">
<code class="descclassname">web.webapi.</code><code class="descname">redirect</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.webapi.Redirect" title="web.webapi.Redirect"><code class="xref py py-class docutils literal"><span class="pre">Redirect</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="web.webapi.found">
<code class="descclassname">web.webapi.</code><code class="descname">found</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.webapi.Found" title="web.webapi.Found"><code class="xref py py-class docutils literal"><span class="pre">Found</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="web.webapi.seeother">
<code class="descclassname">web.webapi.</code><code class="descname">seeother</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.webapi.SeeOther" title="web.webapi.SeeOther"><code class="xref py py-class docutils literal"><span class="pre">SeeOther</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="web.webapi.notmodified">
<code class="descclassname">web.webapi.</code><code class="descname">notmodified</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.webapi.NotModified" title="web.webapi.NotModified"><code class="xref py py-class docutils literal"><span class="pre">NotModified</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="web.webapi.tempredirect">
<code class="descclassname">web.webapi.</code><code class="descname">tempredirect</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.webapi.TempRedirect" title="web.webapi.TempRedirect"><code class="xref py py-class docutils literal"><span class="pre">TempRedirect</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="web.webapi.BadRequest">
<em class="property">exception </em><code class="descclassname">web.webapi.</code><code class="descname">BadRequest</code><span class="sig-paren">(</span><em>message=None</em><span class="sig-paren">)</span></dt>
<dd><p><cite>400 Bad Request</cite> error.</p>
</dd></dl>

<dl class="exception">
<dt id="web.webapi.Unauthorized">
<em class="property">exception </em><code class="descclassname">web.webapi.</code><code class="descname">Unauthorized</code><span class="sig-paren">(</span><em>message=None</em><span class="sig-paren">)</span></dt>
<dd><p><cite>401 Unauthorized</cite> error.</p>
</dd></dl>

<dl class="exception">
<dt id="web.webapi.Forbidden">
<em class="property">exception </em><code class="descclassname">web.webapi.</code><code class="descname">Forbidden</code><span class="sig-paren">(</span><em>message=None</em><span class="sig-paren">)</span></dt>
<dd><p><cite>403 Forbidden</cite> error.</p>
</dd></dl>

<dl class="function">
<dt id="web.webapi.NotFound">
<code class="descclassname">web.webapi.</code><code class="descname">NotFound</code><span class="sig-paren">(</span><em>message=None</em><span class="sig-paren">)</span></dt>
<dd><p>Returns HTTPError with &#8216;404 Not Found&#8217; error from the active application.</p>
</dd></dl>

<dl class="exception">
<dt id="web.webapi.NoMethod">
<em class="property">exception </em><code class="descclassname">web.webapi.</code><code class="descname">NoMethod</code><span class="sig-paren">(</span><em>cls=None</em><span class="sig-paren">)</span></dt>
<dd><p>A <cite>405 Method Not Allowed</cite> error.</p>
</dd></dl>

<dl class="exception">
<dt id="web.webapi.NotAcceptable">
<em class="property">exception </em><code class="descclassname">web.webapi.</code><code class="descname">NotAcceptable</code><span class="sig-paren">(</span><em>message=None</em><span class="sig-paren">)</span></dt>
<dd><p><cite>406 Not Acceptable</cite> error.</p>
</dd></dl>

<dl class="exception">
<dt id="web.webapi.Conflict">
<em class="property">exception </em><code class="descclassname">web.webapi.</code><code class="descname">Conflict</code><span class="sig-paren">(</span><em>message=None</em><span class="sig-paren">)</span></dt>
<dd><p><cite>409 Conflict</cite> error.</p>
</dd></dl>

<dl class="exception">
<dt id="web.webapi.Gone">
<em class="property">exception </em><code class="descclassname">web.webapi.</code><code class="descname">Gone</code><span class="sig-paren">(</span><em>message=None</em><span class="sig-paren">)</span></dt>
<dd><p><cite>410 Gone</cite> error.</p>
</dd></dl>

<dl class="exception">
<dt id="web.webapi.PreconditionFailed">
<em class="property">exception </em><code class="descclassname">web.webapi.</code><code class="descname">PreconditionFailed</code><span class="sig-paren">(</span><em>message=None</em><span class="sig-paren">)</span></dt>
<dd><p><cite>412 Precondition Failed</cite> error.</p>
</dd></dl>

<dl class="exception">
<dt id="web.webapi.UnsupportedMediaType">
<em class="property">exception </em><code class="descclassname">web.webapi.</code><code class="descname">UnsupportedMediaType</code><span class="sig-paren">(</span><em>message=None</em><span class="sig-paren">)</span></dt>
<dd><p><cite>415 Unsupported Media Type</cite> error.</p>
</dd></dl>

<dl class="function">
<dt id="web.webapi.UnavailableForLegalReasons">
<code class="descclassname">web.webapi.</code><code class="descname">UnavailableForLegalReasons</code><span class="sig-paren">(</span><em>message=None</em><span class="sig-paren">)</span></dt>
<dd><p>Returns HTTPError with &#8216;415 Unavailable For Legal Reasons&#8217; error from the active application.</p>
</dd></dl>

<dl class="attribute">
<dt id="web.webapi.badrequest">
<code class="descclassname">web.webapi.</code><code class="descname">badrequest</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.webapi.BadRequest" title="web.webapi.BadRequest"><code class="xref py py-class docutils literal"><span class="pre">BadRequest</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="web.webapi.unauthorized">
<code class="descclassname">web.webapi.</code><code class="descname">unauthorized</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.webapi.Unauthorized" title="web.webapi.Unauthorized"><code class="xref py py-class docutils literal"><span class="pre">Unauthorized</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="web.webapi.forbidden">
<code class="descclassname">web.webapi.</code><code class="descname">forbidden</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.webapi.Forbidden" title="web.webapi.Forbidden"><code class="xref py py-class docutils literal"><span class="pre">Forbidden</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="web.webapi.notfound">
<code class="descclassname">web.webapi.</code><code class="descname">notfound</code><span class="sig-paren">(</span><em>message=None</em><span class="sig-paren">)</span></dt>
<dd><p>Returns HTTPError with &#8216;404 Not Found&#8217; error from the active application.</p>
</dd></dl>

<dl class="attribute">
<dt id="web.webapi.nomethod">
<code class="descclassname">web.webapi.</code><code class="descname">nomethod</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.webapi.NoMethod" title="web.webapi.NoMethod"><code class="xref py py-class docutils literal"><span class="pre">NoMethod</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="web.webapi.notacceptable">
<code class="descclassname">web.webapi.</code><code class="descname">notacceptable</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.webapi.NotAcceptable" title="web.webapi.NotAcceptable"><code class="xref py py-class docutils literal"><span class="pre">NotAcceptable</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="web.webapi.conflict">
<code class="descclassname">web.webapi.</code><code class="descname">conflict</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.webapi.Conflict" title="web.webapi.Conflict"><code class="xref py py-class docutils literal"><span class="pre">Conflict</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="web.webapi.gone">
<code class="descclassname">web.webapi.</code><code class="descname">gone</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.webapi.Gone" title="web.webapi.Gone"><code class="xref py py-class docutils literal"><span class="pre">Gone</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="web.webapi.preconditionfailed">
<code class="descclassname">web.webapi.</code><code class="descname">preconditionfailed</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.webapi.PreconditionFailed" title="web.webapi.PreconditionFailed"><code class="xref py py-class docutils literal"><span class="pre">PreconditionFailed</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="web.webapi.unsupportedmediatype">
<code class="descclassname">web.webapi.</code><code class="descname">unsupportedmediatype</code></dt>
<dd><p>alias of <a class="reference internal" href="#web.webapi.UnsupportedMediaType" title="web.webapi.UnsupportedMediaType"><code class="xref py py-class docutils literal"><span class="pre">UnsupportedMediaType</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="web.webapi.unavailableforlegalreasons">
<code class="descclassname">web.webapi.</code><code class="descname">unavailableforlegalreasons</code><span class="sig-paren">(</span><em>message=None</em><span class="sig-paren">)</span></dt>
<dd><p>Returns HTTPError with &#8216;415 Unavailable For Legal Reasons&#8217; error from the active application.</p>
</dd></dl>

<dl class="function">
<dt id="web.webapi.InternalError">
<code class="descclassname">web.webapi.</code><code class="descname">InternalError</code><span class="sig-paren">(</span><em>message=None</em><span class="sig-paren">)</span></dt>
<dd><p>Returns HTTPError with &#8216;500 internal error&#8217; error from the active application.</p>
</dd></dl>

<dl class="function">
<dt id="web.webapi.internalerror">
<code class="descclassname">web.webapi.</code><code class="descname">internalerror</code><span class="sig-paren">(</span><em>message=None</em><span class="sig-paren">)</span></dt>
<dd><p>Returns HTTPError with &#8216;500 internal error&#8217; error from the active application.</p>
</dd></dl>

</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>

    <div class="footer" role="contentinfo">
        &copy; Copyright .
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.5.
    </div>
  </body>
</html>